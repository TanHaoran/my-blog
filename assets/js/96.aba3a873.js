(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{302:function(e,a,t){"use strict";t.r(a);var o=t(0),r=Object(o.a)({},(function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"解决微信退款回调解密异常的问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决微信退款回调解密异常的问题"}},[e._v("#")]),e._v(" 解决微信退款回调解密异常的问题")]),e._v(" "),t("Counter",{attrs:{path:"project",name:"解决微信退款回调解密异常的问题"}}),e._v(" "),t("p",[e._v("在做微信支付开发的时候会涉及到微信退款功能，当发起微信退款之后，如果微信受理成功会回调我们自己写的一个接口，在这个接口中，微信会返回一段 "),t("code",[e._v("xml")]),e._v(" 字符串，在 "),t("code",[e._v("<req_info>")]),e._v(" 这个节点中会包含一个 "),t("code",[e._v("Base64")]),e._v(" 加密的字符串，需要我们做 "),t("code",[e._v("base64")]),e._v(" 解码操作，解码后还需要做 "),t("code",[e._v("AES/ECB/PKCS5Padding")]),e._v(" 的解密操作，在这个解密的过程中会抛出这样一个异常；")]),e._v(" "),t("div",{staticClass:"language-coneole line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("java.security.InvalidKeyException: Illegal key size or default parameters\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("这是因为密钥长度受限了，"),t("code",[e._v("java")]),e._v(" 在运行时环境读到的是受限的 "),t("code",[e._v("policy")]),e._v(" 文件。文件位于服务器 "),t("code",[e._v("${java_home}/jre/lib/security")]),e._v(" 下，这种限制是因为美国对软件出口的控制，此时我们需要下载 "),t("code",[e._v("Java Cryptography Extension (JCE) Unlimited Strength Jurisdiction Policy Files")]),e._v("，下载的文件版本必须和 "),t("code",[e._v("jdk")]),e._v(" 版本对应。")]),e._v(" "),t("p",[e._v("比如我们使用的是 "),t("code",[e._v("jdk 1.8")]),e._v(" ，那么就需要下载对应的 "),t("code",[e._v("jce_policy-8")]),e._v("，去Oracle官网下载，这里给出下载地址："),t("a",{attrs:{href:"https://www.oracle.com/technetwork/cn/java/javase/downloads/jce8-download-2133166-zhs.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("jce8下载"),t("OutboundLink")],1),e._v(" ，下载好后解压，将里面的 "),t("code",[e._v("local_policy.jar")]),e._v(" 和 "),t("code",[e._v("US_export_policy.jar")]),e._v(" 覆盖掉服务器上 "),t("code",[e._v("${java_home}/jre/lib/security")]),e._v(" 下对应的两个文件，此时就可以无限制解密了。")]),e._v(" "),t("Valine")],1)}),[],!1,null,null,null);a.default=r.exports}}]);