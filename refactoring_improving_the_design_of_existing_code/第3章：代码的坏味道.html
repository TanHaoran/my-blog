<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第3章：代码的坏味道 | 林山夕风</title>
    <meta name="description" content="林山夕风的博客,md文档,技术博客">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/my-blog/avatar.jpg">
  <script>
                var _hmt = _hmt || [];
                (function() {
                    var hm = document.createElement("script");
                    hm.src = "https://hm.baidu.com/hm.js?68e7a949df184c1e4c82b115461e51e0";
                    var s = document.getElementsByTagName("script")[0];
                    s.parentNode.insertBefore(hm, s);
                })();
            </script>
    
    <link rel="preload" href="/my-blog/assets/css/0.styles.67b6080f.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.11c55fdf.js" as="script"><link rel="preload" href="/my-blog/assets/js/2.f643b0a2.js" as="script"><link rel="preload" href="/my-blog/assets/js/100.07e38629.js" as="script"><link rel="preload" href="/my-blog/assets/js/4.fd36f240.js" as="script"><link rel="preload" href="/my-blog/assets/js/5.628d6842.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.f4eaa613.js"><link rel="prefetch" href="/my-blog/assets/js/101.dcfe2bf2.js"><link rel="prefetch" href="/my-blog/assets/js/102.209999b3.js"><link rel="prefetch" href="/my-blog/assets/js/103.a9a85d34.js"><link rel="prefetch" href="/my-blog/assets/js/104.fdefe1dc.js"><link rel="prefetch" href="/my-blog/assets/js/105.e4b5d0af.js"><link rel="prefetch" href="/my-blog/assets/js/106.cf83f84b.js"><link rel="prefetch" href="/my-blog/assets/js/107.848b42d5.js"><link rel="prefetch" href="/my-blog/assets/js/108.351fb64c.js"><link rel="prefetch" href="/my-blog/assets/js/109.4b9111f6.js"><link rel="prefetch" href="/my-blog/assets/js/11.5d5723d1.js"><link rel="prefetch" href="/my-blog/assets/js/110.7f24fb6a.js"><link rel="prefetch" href="/my-blog/assets/js/111.28300395.js"><link rel="prefetch" href="/my-blog/assets/js/112.839af357.js"><link rel="prefetch" href="/my-blog/assets/js/113.67de001a.js"><link rel="prefetch" href="/my-blog/assets/js/114.408ea2f6.js"><link rel="prefetch" href="/my-blog/assets/js/115.34a1d81a.js"><link rel="prefetch" href="/my-blog/assets/js/116.f510ca2c.js"><link rel="prefetch" href="/my-blog/assets/js/117.24ddf316.js"><link rel="prefetch" href="/my-blog/assets/js/12.06fcb150.js"><link rel="prefetch" href="/my-blog/assets/js/13.c441de9d.js"><link rel="prefetch" href="/my-blog/assets/js/14.ca26e948.js"><link rel="prefetch" href="/my-blog/assets/js/15.e7761bd0.js"><link rel="prefetch" href="/my-blog/assets/js/16.5be4d33f.js"><link rel="prefetch" href="/my-blog/assets/js/17.4426a95c.js"><link rel="prefetch" href="/my-blog/assets/js/18.7d974f8d.js"><link rel="prefetch" href="/my-blog/assets/js/19.775995bc.js"><link rel="prefetch" href="/my-blog/assets/js/20.71c35e12.js"><link rel="prefetch" href="/my-blog/assets/js/21.741a18a7.js"><link rel="prefetch" href="/my-blog/assets/js/22.819a7e85.js"><link rel="prefetch" href="/my-blog/assets/js/23.f9133433.js"><link rel="prefetch" href="/my-blog/assets/js/24.86a7d541.js"><link rel="prefetch" href="/my-blog/assets/js/25.0aa2d6ab.js"><link rel="prefetch" href="/my-blog/assets/js/26.3e55392e.js"><link rel="prefetch" href="/my-blog/assets/js/27.ae2e0581.js"><link rel="prefetch" href="/my-blog/assets/js/28.aaa62b88.js"><link rel="prefetch" href="/my-blog/assets/js/29.55007ae9.js"><link rel="prefetch" href="/my-blog/assets/js/3.57915124.js"><link rel="prefetch" href="/my-blog/assets/js/30.63aac023.js"><link rel="prefetch" href="/my-blog/assets/js/31.d5607214.js"><link rel="prefetch" href="/my-blog/assets/js/32.a7ae912b.js"><link rel="prefetch" href="/my-blog/assets/js/33.58fcbfa4.js"><link rel="prefetch" href="/my-blog/assets/js/34.8538d781.js"><link rel="prefetch" href="/my-blog/assets/js/35.14a82428.js"><link rel="prefetch" href="/my-blog/assets/js/36.2ad806dd.js"><link rel="prefetch" href="/my-blog/assets/js/37.207a29ce.js"><link rel="prefetch" href="/my-blog/assets/js/38.57c0d12e.js"><link rel="prefetch" href="/my-blog/assets/js/39.83aff8a9.js"><link rel="prefetch" href="/my-blog/assets/js/40.bcbcfd03.js"><link rel="prefetch" href="/my-blog/assets/js/41.d0a94dfd.js"><link rel="prefetch" href="/my-blog/assets/js/42.f6011b50.js"><link rel="prefetch" href="/my-blog/assets/js/43.efd29b4c.js"><link rel="prefetch" href="/my-blog/assets/js/44.e5c9709c.js"><link rel="prefetch" href="/my-blog/assets/js/45.7656da3c.js"><link rel="prefetch" href="/my-blog/assets/js/46.0f46c833.js"><link rel="prefetch" href="/my-blog/assets/js/47.40ce4540.js"><link rel="prefetch" href="/my-blog/assets/js/48.3db9c583.js"><link rel="prefetch" href="/my-blog/assets/js/49.53285ac3.js"><link rel="prefetch" href="/my-blog/assets/js/50.4db56f99.js"><link rel="prefetch" href="/my-blog/assets/js/51.188f8c4f.js"><link rel="prefetch" href="/my-blog/assets/js/52.95be221e.js"><link rel="prefetch" href="/my-blog/assets/js/53.276e1791.js"><link rel="prefetch" href="/my-blog/assets/js/54.2fd73796.js"><link rel="prefetch" href="/my-blog/assets/js/55.c90a5bd8.js"><link rel="prefetch" href="/my-blog/assets/js/56.406f89df.js"><link rel="prefetch" href="/my-blog/assets/js/57.811f05ab.js"><link rel="prefetch" href="/my-blog/assets/js/58.e2896a54.js"><link rel="prefetch" href="/my-blog/assets/js/59.e5f3be54.js"><link rel="prefetch" href="/my-blog/assets/js/6.8ba90f8e.js"><link rel="prefetch" href="/my-blog/assets/js/60.e4b67c15.js"><link rel="prefetch" href="/my-blog/assets/js/61.7b772903.js"><link rel="prefetch" href="/my-blog/assets/js/62.bbe4352b.js"><link rel="prefetch" href="/my-blog/assets/js/63.e350ef3b.js"><link rel="prefetch" href="/my-blog/assets/js/64.7b6ca2f6.js"><link rel="prefetch" href="/my-blog/assets/js/65.76baf7fa.js"><link rel="prefetch" href="/my-blog/assets/js/66.ff801cea.js"><link rel="prefetch" href="/my-blog/assets/js/67.ee30cd5b.js"><link rel="prefetch" href="/my-blog/assets/js/68.0f4c1ce2.js"><link rel="prefetch" href="/my-blog/assets/js/69.111ce4de.js"><link rel="prefetch" href="/my-blog/assets/js/7.55078740.js"><link rel="prefetch" href="/my-blog/assets/js/70.46f8b5e8.js"><link rel="prefetch" href="/my-blog/assets/js/71.675e279c.js"><link rel="prefetch" href="/my-blog/assets/js/72.c419d947.js"><link rel="prefetch" href="/my-blog/assets/js/73.6eb4799a.js"><link rel="prefetch" href="/my-blog/assets/js/74.18229d2e.js"><link rel="prefetch" href="/my-blog/assets/js/75.46c8298d.js"><link rel="prefetch" href="/my-blog/assets/js/76.c966d3c5.js"><link rel="prefetch" href="/my-blog/assets/js/77.b31efc9c.js"><link rel="prefetch" href="/my-blog/assets/js/78.f7e57735.js"><link rel="prefetch" href="/my-blog/assets/js/79.e056b5a5.js"><link rel="prefetch" href="/my-blog/assets/js/8.ddecccf2.js"><link rel="prefetch" href="/my-blog/assets/js/80.0fc539d1.js"><link rel="prefetch" href="/my-blog/assets/js/81.2b7f0d10.js"><link rel="prefetch" href="/my-blog/assets/js/82.d3e4b716.js"><link rel="prefetch" href="/my-blog/assets/js/83.3073a1d2.js"><link rel="prefetch" href="/my-blog/assets/js/84.d231aeff.js"><link rel="prefetch" href="/my-blog/assets/js/85.7daed020.js"><link rel="prefetch" href="/my-blog/assets/js/86.0c8d8d8e.js"><link rel="prefetch" href="/my-blog/assets/js/87.c4ba5f03.js"><link rel="prefetch" href="/my-blog/assets/js/88.9a4e0ef6.js"><link rel="prefetch" href="/my-blog/assets/js/89.b7bca56b.js"><link rel="prefetch" href="/my-blog/assets/js/9.7463f385.js"><link rel="prefetch" href="/my-blog/assets/js/90.49ec4345.js"><link rel="prefetch" href="/my-blog/assets/js/91.84cb7a66.js"><link rel="prefetch" href="/my-blog/assets/js/92.cb5ea946.js"><link rel="prefetch" href="/my-blog/assets/js/93.05e2ac79.js"><link rel="prefetch" href="/my-blog/assets/js/94.e60969c0.js"><link rel="prefetch" href="/my-blog/assets/js/95.688af442.js"><link rel="prefetch" href="/my-blog/assets/js/96.aba3a873.js"><link rel="prefetch" href="/my-blog/assets/js/97.ca8196eb.js"><link rel="prefetch" href="/my-blog/assets/js/98.071b3a0f.js"><link rel="prefetch" href="/my-blog/assets/js/99.eca50447.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.67b6080f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><!----> <span class="site-name">林山夕风</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础教程" class="dropdown-title"><span class="title">基础教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/frontend/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/backend/" class="nav-link">
  后端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/enjoy3/" class="nav-link">
  进阶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据结构与算法" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/structure/" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/algorithm/" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/leetcode/" class="nav-link">
  LeetCode题解
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计思想" class="dropdown-title"><span class="title">设计思想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/principle/" class="nav-link">
  设计原则
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/pattern/" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/thinking_in_java/" class="nav-link">
  Java编程思想
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/refactoring_improving_the_design_of_existing_code/" class="nav-link router-link-active">
  重构改善既有代码的设计
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/project/" class="nav-link">
  项目实战
</a></div><div class="nav-item"><a href="/my-blog/article/" class="nav-link">
  零散文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/doomthr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/TanHaoran" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础教程" class="dropdown-title"><span class="title">基础教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/frontend/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/backend/" class="nav-link">
  后端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/enjoy3/" class="nav-link">
  进阶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据结构与算法" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/structure/" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/algorithm/" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/leetcode/" class="nav-link">
  LeetCode题解
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计思想" class="dropdown-title"><span class="title">设计思想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/principle/" class="nav-link">
  设计原则
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/pattern/" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/thinking_in_java/" class="nav-link">
  Java编程思想
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/refactoring_improving_the_design_of_existing_code/" class="nav-link router-link-active">
  重构改善既有代码的设计
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/project/" class="nav-link">
  项目实战
</a></div><div class="nav-item"><a href="/my-blog/article/" class="nav-link">
  零散文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/doomthr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/TanHaoran" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>重构改善既有代码的设计</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第1章：重构，第一个案例.html" class="sidebar-link">第1章：重构，第一个案例</a></li><li><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第2章：重构原则.html" class="sidebar-link">第2章：重构原则</a></li><li><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html" class="active sidebar-link">第3章：代码的坏味道</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#一、duplicated-code（重复代码）" class="sidebar-link">一、Duplicated Code（重复代码）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#二、long-method（过长函数）" class="sidebar-link">二、Long Method（过长函数）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#三、large-class（过大的类）" class="sidebar-link">三、Large Class（过大的类）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#四、long-parameter-list（过场参数列）" class="sidebar-link">四、Long Parameter List（过场参数列）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#五、divergent-change（发散式变化）" class="sidebar-link">五、Divergent Change（发散式变化）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#六、shotgun-surgery（霞弹式修改）" class="sidebar-link">六、Shotgun Surgery（霞弹式修改）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#七、feature-envy（依恋情节）" class="sidebar-link">七、Feature Envy（依恋情节）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#八、data-clumps（数据泥团）" class="sidebar-link">八、Data Clumps（数据泥团）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#九、primitive-obsession（基本类型偏执）" class="sidebar-link">九、Primitive Obsession（基本类型偏执）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十、switch-statements（switch惊悚现身）" class="sidebar-link">十、Switch Statements（Switch惊悚现身）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十一、parallel-inheritance-hierarchies（平行继承体系）" class="sidebar-link">十一、Parallel Inheritance Hierarchies（平行继承体系）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十二、lazy-class（冗赘类）" class="sidebar-link">十二、Lazy Class（冗赘类）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十四、temporary-field（令人迷惑的暂时字段）" class="sidebar-link">十四、Temporary Field（令人迷惑的暂时字段）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十五、message-chains（过度耦合的消息链）" class="sidebar-link">十五、Message Chains（过度耦合的消息链）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十六、middle-man（中间人）" class="sidebar-link">十六、Middle Man（中间人）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十七、inappropriate-intimacy（狎昵关系）" class="sidebar-link">十七、Inappropriate Intimacy（狎昵关系）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十八、alternative-classes-with-different-interfaces（异曲同工的类）" class="sidebar-link">十八、Alternative Classes with Different Interfaces（异曲同工的类）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#十九、incomplete-library-class（不完美的库类）" class="sidebar-link">十九、Incomplete Library Class（不完美的库类）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#二十、data-class（纯稚的数据类型）" class="sidebar-link">二十、Data Class（纯稚的数据类型）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#二十一、refused-bequest（被拒绝的遗赠）" class="sidebar-link">二十一、Refused Bequest（被拒绝的遗赠）</a></li><li class="sidebar-sub-header"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html#二十二、conmments（过多的注释）" class="sidebar-link">二十二、Conmments（过多的注释）</a></li></ul></li><li><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第4章：构筑测试体系.html" class="sidebar-link">第4章：构筑测试体系</a></li><li><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第5章：重构列表.html" class="sidebar-link">第5章：重构列表</a></li><li><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第6章：重新组织函数.html" class="sidebar-link">第6章：重新组织函数</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="第3章：代码的坏味道"><a href="#第3章：代码的坏味道" class="header-anchor">#</a> 第3章：代码的坏味道</h1> <div><span id="/my-blog/refactoring_improving_the_design_of_existing_code/第3章：代码的坏味道.html" data-flag-title="第3章：代码的坏味道" class="leancloud_visitors read-count"><em class="post-meta-item-text">阅读量 </em> <i class="leancloud-visitors-count">loading</i></span> <div class="clear-both"></div></div> <h2 id="一、duplicated-code（重复代码）"><a href="#一、duplicated-code（重复代码）" class="header-anchor">#</a> 一、Duplicated Code（重复代码）</h2> <p>如果在一个以上的地点看到相同的程序结构，那么可以肯定：设法将它们合二为一，程序会变的更好。</p> <ul><li>同一个类的两个函数含有相同的表达式</li></ul> <p>这时候采用 <code>Extract Method</code> 需提炼出重复的代码，让这两个地点都调用被提炼出来的那一段代码。</p> <ul><li>两个互为兄弟的子类内含有相同表达式</li></ul> <p>需对两个类都使用 <code>Extract Method</code>，再对被提炼出来的代码使用 <code>Pull Up Method</code> 将它推入超类内。如果代码之间只是类似，并非完全相同，那么就得运用 <code>Extract Method</code> 将相似部分和差一部分割开，够成单独一个函数，然后可以运用 <code>Form Template Method</code> 获得一个模板方法设计模式。如果有些函数以不同的算法做相同的事，可以选择其中一个较清晰的，使用 <code>Substitute Algorithm</code> 将其他函数的算法替换掉。</p> <ul><li>两个毫不相关的类出现重复代码</li></ul> <p>考虑对其中一个使用 <code>Extract Class</code>，将重复代码提炼到一个独立类中，然后在另一个类内使用这个新类。但是重复代码所在的函数也可能的确只应该属于某个类，另一个类只能调用它，或者这个函数可能属于第三个类，而另外两个类应引用这第三个类。你必须决定这个函数放在哪最合适，并确保被安置后就不会再在其它地方出现。</p> <h2 id="二、long-method（过长函数）"><a href="#二、long-method（过长函数）" class="header-anchor">#</a> 二、Long Method（过长函数）</h2> <p>每当感觉医嘱是来说明点什么的时候，我们就把需要说明的东西写进一个独立函数中，并以其用途（而非实现手法）命名。</p> <p>如果函数内有大量的参数和临时变量，这会对提炼函数形成阻碍，如果使用 <code>Extract Method</code>，最终会产生很多参数和临时变量，导致程序没有可读性。此时可以运用 <code>Replace Temp with Query</code> 来消除这些临时元素。<code>Introduce Parameter Object</code> 和 <code>Preserve Whole Object</code> 则可以将过长的参数列变的更简洁一些。如果这么做还有太多临时变量和参数，那么就使用杀手锏 <code>Replace Method with Method Object</code>。</p> <p>如何确定该提炼哪一行代码呢？一个很好的技巧是：寻找注释。它们通常能指出代码用途和实现手法之间的语意距离。如果代码前方有一行注释，它就是在提醒你：可以将这段代码替换成一个函数，而且可以在注释的基础上给这个函数命名。就算只有一行代码，如果他需要以注释来说明，那也值得将它提炼到独立函数中去。</p> <p>条件表达式和循环常常也是提炼的信号。可以使用 <code>Decompose Conditional</code> 处理条件表达式。至于循环，应该将循环和其内的代码提炼到一个独立函数中。</p> <h2 id="三、large-class（过大的类）"><a href="#三、large-class（过大的类）" class="header-anchor">#</a> 三、Large Class（过大的类）</h2> <p>可以运用 <code>Extract Class</code> 将几个变量一起提炼至新类内。提炼时应该选择类内彼此相关的变量，将它们放在一起。例如 <code>depositAmount</code> 和 <code>depositCurrency</code> 可能应该隶属于同一个类。通常如果类内的数个变量有着相同的前缀或字尾，这就意味着机会把它们提炼到某个组件内。如果这个组件适合作为一个子类，你会发现 <code>Extract Subclass</code> 往往比较简单。</p> <p>这里有个技巧：先确定客户端如何使用它们，然后运用 <code>Extract Interface</code> 为每一种使用方式提炼出一个接口。者获取可以帮助你看清楚如何分解这个类。</p> <h2 id="四、long-parameter-list（过场参数列）"><a href="#四、long-parameter-list（过场参数列）" class="header-anchor">#</a> 四、Long Parameter List（过场参数列）</h2> <p>太长的参数列难以理解，太多参数会造成前后不一致、不易使用。而且一旦你需要更多数据，就不得不修改它。如果将对象传递给函数，大多数修改都讲没有必要，因为你很可鞥呢只需（在函数内）增加一两条请求，就能得到更多数据。</p> <p>你可以运用 <code>Preserve Whole Object</code> 将来自同一对象的一堆数据收集起来，并以该对象替换它们。如果某些数据缺乏合理的对象归属，可以使用 <code>Introduct Parameter Object</code> 将它们制造出一个“参数对象”。</p> <h2 id="五、divergent-change（发散式变化）"><a href="#五、divergent-change（发散式变化）" class="header-anchor">#</a> 五、Divergent Change（发散式变化）</h2> <p>如果某个类经常因为不同的原因在不同的方向上变化，那么此时也许将这个对象分成两个会更好，这么一来每个对象就可以只因为一种变化而需要修改。针对某一外界变化所有的修改，都应该只发生在单一类中，而这个新提炼出来的类内的所有内容都应该反映此变化。你应该找出某些特定原因造成的所有变化，然后运用 <code>Extract Class</code> 将它们提炼到另一个类中。</p> <h2 id="六、shotgun-surgery（霞弹式修改）"><a href="#六、shotgun-surgery（霞弹式修改）" class="header-anchor">#</a> 六、Shotgun Surgery（霞弹式修改）</h2> <p>类似 <code>Divergent Change</code>，如果每遇到某种变化，都需要在不同的类内做出修改，此时面临的就是 <code>Shotgun Surgery</code>。因为需要修改的代码散布四处，很难找到它们，也很容易忘记某个重要的修改。</p> <p>此时应该使用 <code>Move Method</code> 和 <code>Move Field</code> 把所有需要修改的代码放进同一个类。如果没有合适的类就创建一个。通常可以使用 Inline Class 把一些列相关行为放进同一个类。</p> <h2 id="七、feature-envy（依恋情节）"><a href="#七、feature-envy（依恋情节）" class="header-anchor">#</a> 七、Feature Envy（依恋情节）</h2> <p>经常某个函数为了计算某个值，从另一个对象那调用了几乎半打的取值函数，这时就应该使用 <code>Move Method</code> 把这个函数移至另一个地点。</p> <p>一个函数往往会用到几个类的功能，那么原则是：判断哪个类拥有最多被此函数使用的数据，然后就把这个函数和那些数据摆在一起。如果先以 <code>Extract Method</code> 将这个函数分解为数个较小的函数并分别放置于不同地点，上述步骤也就容易完成了。</p> <h2 id="八、data-clumps（数据泥团）"><a href="#八、data-clumps（数据泥团）" class="header-anchor">#</a> 八、Data Clumps（数据泥团）</h2> <p>找出类中或者函数中相同参数的数据字段，运用 <code>Extract Class</code> 将它们提炼到一个独立对象中。</p> <p>一个好的评判办法是：删掉众多数据中的一项。这么做，其他数据有没有因而失去意义？如果它们不再有意义，这就是个明确信号：你应该为它们产生一个新对象。</p> <h2 id="九、primitive-obsession（基本类型偏执）"><a href="#九、primitive-obsession（基本类型偏执）" class="header-anchor">#</a> 九、Primitive Obsession（基本类型偏执）</h2> <p>你可以运用 <code>Replace Data Value with Object</code> 将原本单独存在的数据值替换为对象，从而走出传统的洞窟，进入炙手可热的对象世界。如果想要替换的数据值是类型码，而它并不影响行为，则可以运用 <code>Replace Type Code with Class</code> 将它替换掉。如果你又与类型码相关的条件表达式，可运用 <code>Replace Type Code with Subclass</code> 或 <code>Replace Type Code with State/Strategy</code> 加以处理。</p> <p>如果你有一组应该总是被放在一起的字段，可运用 <code>Extract Class</code>。如果在参数列中看到基本类型，不妨试试 <code>Introduce Parameter Object</code>。如果发现自己正从数组中挑选数据，可运用 <code>Replace Array with Object</code>。</p> <h2 id="十、switch-statements（switch惊悚现身）"><a href="#十、switch-statements（switch惊悚现身）" class="header-anchor">#</a> 十、Switch Statements（Switch惊悚现身）</h2> <p>应该使用 <code>Extract Method</code> 将 <code>Switch</code> 语句提炼到一个独立函数中，再以 <code>Move Method</code> 将它搬移到需要多态性的那个类里。此时你必须决定是否使用 <code>Replace Type Code with Subclasses</code> 或 <code>Replace Type Code with State/Stratery</code>。一旦这样完成继承结构之后，就可以运用 <code>Replace Conditional with Polymorphism</code> 了。</p> <p>如果你只是在单一函数中有些选择事例，且并不想改动它们，那么多态就有点杀鸡用牛刀了。这种情况下 <code>Replace Parameter with Explicit Methods</code> 是个不错的选择。如果你的选择条件之一是 <code>null</code>，可以试试 <code>Introduce Null Object</code>。</p> <h2 id="十一、parallel-inheritance-hierarchies（平行继承体系）"><a href="#十一、parallel-inheritance-hierarchies（平行继承体系）" class="header-anchor">#</a> 十一、Parallel Inheritance Hierarchies（平行继承体系）</h2> <p><code>Parallel Inheritance Hierarchies</code> 其实是 <code>Shotgun Surgery</code> 的特殊情况。这种情况下，每当你为某个类增加一个子类，必须也为另一个类相应增加一个子类。</p> <p>消除这种重复性的一般策略是：让一个继承体系的实例引用另一个继承体系的实例。如果再接再厉运用 <code>Move Method</code> 和 <code>Move Field</code> 就可以将引用端的继承体消弭儿于无形。</p> <h2 id="十二、lazy-class（冗赘类）"><a href="#十二、lazy-class（冗赘类）" class="header-anchor">#</a> 十二、Lazy Class（冗赘类）</h2> <p>如果一个类的所得不值其身价，它就应该消失。</p> <h2 id="十四、temporary-field（令人迷惑的暂时字段）"><a href="#十四、temporary-field（令人迷惑的暂时字段）" class="header-anchor">#</a> 十四、Temporary Field（令人迷惑的暂时字段）</h2> <p>某个对象内的某个实例变量近卫某种特定情况而设，请使用 <code>Extract Class</code> 给这些孤儿创造一个家。</p> <p>如果类中有一个复杂算法，需要好几个参数，但是里面部分参数只在使用该算法时才有效，其他情况下这会让人迷惑。这时候你可以使用 <code>Extract Class</code> 把这些变量和其相关函数提炼到一个独立类中。提炼后的新对象僵尸一个函数对象。</p> <h2 id="十五、message-chains（过度耦合的消息链）"><a href="#十五、message-chains（过度耦合的消息链）" class="header-anchor">#</a> 十五、Message Chains（过度耦合的消息链）</h2> <p>向一个对象A请求对象B，向对象B请求对象C，以此类推，这就是消息链。先观察消息链最终得到的对象是用来干什么的，看看能否以 <code>Extract Method</code> 把使用该对象的嗲吗提炼到一个独立函数中，再运用 <code>Move Method</code> 把这个函数兑入消息链。</p> <h2 id="十六、middle-man（中间人）"><a href="#十六、middle-man（中间人）" class="header-anchor">#</a> 十六、Middle Man（中间人）</h2> <p>你也许会看到某个类接口有一半的函数都委托给其他类，这样就是过度运用。应该使用 <code>Remove Middle Man</code>，直接和真正负责的对象打交道。如果这样的函数只有少数几个，可以运用 <code>InlineMethod</code> 把它们放进调用端。如果这些 <code>Middle Man</code> 还有其他行为，可以运用 <code>Replace Delegation with Inheritance</code> 把它变成实责对象的子类，这样你既可以扩展原对象的行为，又不必负担那么多的委托动作。</p> <h2 id="十七、inappropriate-intimacy（狎昵关系）"><a href="#十七、inappropriate-intimacy（狎昵关系）" class="header-anchor">#</a> 十七、Inappropriate Intimacy（狎昵关系）</h2> <p>可以看看是否可以运用 <code>Change Bidirectional Association to Unidirectional</code> 让其中一个类对另一个斩断情丝。如果两个类实在是情投意合，可以运用 <code>Extract Class</code> 把两者共同点提炼到一个秦宣地点，让它们坦荡地使用这个心累。或者也可以尝试运用 <code>Hide Delegate</code> 让另一个类来为它们传递私情。</p> <p>继承往往造成过度亲密，因为子类对超类的了解总是超过后者的主观愿望。如果你觉得这个孩子独自生活了，运用 <code>Replace Inheritance with Delegation</code> 让它离开继承体系。</p> <h2 id="十八、alternative-classes-with-different-interfaces（异曲同工的类）"><a href="#十八、alternative-classes-with-different-interfaces（异曲同工的类）" class="header-anchor">#</a> 十八、Alternative Classes with Different Interfaces（异曲同工的类）</h2> <p>如果两函数做同一件事，却有着不同的签名，请运用 <code>Rename Method</code> 根据它们的用途重新命名。但这往往不够，请反复运用 <code>Move Method</code> 将某些行为移入类，直到两者的协议一直为止。如果你必须重复而赘余地移入代码才能完成这些，或者可以使用 <code>Extract Superclass</code> 为自己赎点罪。</p> <h2 id="十九、incomplete-library-class（不完美的库类）"><a href="#十九、incomplete-library-class（不完美的库类）" class="header-anchor">#</a> 十九、Incomplete Library Class（不完美的库类）</h2> <p>如果你只想修改库类的一两个函数，可以运用 <code>Introduce Foreign Method</code>；如果想要添加一大堆额外行为，就得运用 <code>Introduce Local Extension</code>。</p> <h2 id="二十、data-class（纯稚的数据类型）"><a href="#二十、data-class（纯稚的数据类型）" class="header-anchor">#</a> 二十、Data Class（纯稚的数据类型）</h2> <p><code>Data Class</code> 是指拥有一些字段，以及用于访问（读写）这些字段的函数，除此之外一无长物的类。这些类早起可能拥有 <code>public</code> 字段，果真如此你应该在别人注意到它们之前，立刻运用 <code>Encapsulate Field</code> 将它们封装起来。如果这些类内含容器类的字段，你应该检查它们是不是得到了恰当的封装：如果没有，就运用 <code>Encapsulate Collection</code> 把它们封装起来，对于那些不该被其他类修改的字段，请运用 <code>Remove Setting Method</code>。</p> <p>然后找出这些取值/设值函数被其他类运用的地点。尝试以 <code>Move Method</code> 把那些调用行为搬移到 <code>Data Class</code> 来。如果无法搬移整个函数，就运用 <code>Extract Method</code> 产生一个可以被搬移的函数。不久之后你就可以运用 <code>Hide Method</code> 把这些取值/设值函数隐藏起来了。</p> <h2 id="二十一、refused-bequest（被拒绝的遗赠）"><a href="#二十一、refused-bequest（被拒绝的遗赠）" class="header-anchor">#</a> 二十一、Refused Bequest（被拒绝的遗赠）</h2> <p>你常常会听到这样的建议：所有超类都应该是抽象的。</p> <p>如果子类复用了超类的行为（实现）缺又不愿意支持超类的接口，如果不愿意继承接口的话，应该运用 <code>Replace Inheritance with Delegation</code> 来达到目的。</p> <h2 id="二十二、conmments（过多的注释）"><a href="#二十二、conmments（过多的注释）" class="header-anchor">#</a> 二十二、Conmments（过多的注释）</h2> <p>如果你需要注释来解释一块代码做了什么，试试 <code>Extrace Method</code>，如果函数已经提炼出来，但还是需要注释来解释其行为，试试 <code>Rename Method</code>；如果你需要注释说明某些系统的需求规格，试试 <code>Introduce Assertion</code>。</p> <p><strong>当你感觉需要撰写注释时，请先尝试重构，试着让所有注释都变得多余</strong></p> <p>如果你不知道该做什么，这才是注释的良好运用时机。除了 用来记述将来的打算之外，注释还可以用来标记你并无十足把握的区域，你可以在注释里写下自己“为什么做某某事”。这类信息可以帮助将来的修改者，尤其是那些健忘的家伙。</p> <div><br> <div id="vcomments"></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020-08-21 09:02:51（10 小时前）</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/my-blog/refactoring_improving_the_design_of_existing_code/第2章：重构原则.html" class="prev">
        第2章：重构原则
      </a></span> <span class="next"><a href="/my-blog/refactoring_improving_the_design_of_existing_code/第4章：构筑测试体系.html">
        第4章：构筑测试体系
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-blog/assets/js/app.11c55fdf.js" defer></script><script src="/my-blog/assets/js/2.f643b0a2.js" defer></script><script src="/my-blog/assets/js/100.07e38629.js" defer></script><script src="/my-blog/assets/js/4.fd36f240.js" defer></script><script src="/my-blog/assets/js/5.628d6842.js" defer></script>
  </body>
</html>
