<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MySQL安装和基础数据类型 | 林山夕风</title>
    <meta name="description" content="林山夕风的博客,md文档,技术博客">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/my-blog/avatar.jpg">
  <script>
                var _hmt = _hmt || [];
                (function() {
                    var hm = document.createElement("script");
                    hm.src = "https://hm.baidu.com/hm.js?68e7a949df184c1e4c82b115461e51e0";
                    var s = document.getElementsByTagName("script")[0];
                    s.parentNode.insertBefore(hm, s);
                })();
            </script>
    
    <link rel="preload" href="/my-blog/assets/css/0.styles.67b6080f.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.11c55fdf.js" as="script"><link rel="preload" href="/my-blog/assets/js/2.f643b0a2.js" as="script"><link rel="preload" href="/my-blog/assets/js/24.86a7d541.js" as="script"><link rel="preload" href="/my-blog/assets/js/4.fd36f240.js" as="script"><link rel="preload" href="/my-blog/assets/js/5.628d6842.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.f4eaa613.js"><link rel="prefetch" href="/my-blog/assets/js/100.07e38629.js"><link rel="prefetch" href="/my-blog/assets/js/101.dcfe2bf2.js"><link rel="prefetch" href="/my-blog/assets/js/102.209999b3.js"><link rel="prefetch" href="/my-blog/assets/js/103.a9a85d34.js"><link rel="prefetch" href="/my-blog/assets/js/104.fdefe1dc.js"><link rel="prefetch" href="/my-blog/assets/js/105.e4b5d0af.js"><link rel="prefetch" href="/my-blog/assets/js/106.cf83f84b.js"><link rel="prefetch" href="/my-blog/assets/js/107.848b42d5.js"><link rel="prefetch" href="/my-blog/assets/js/108.351fb64c.js"><link rel="prefetch" href="/my-blog/assets/js/109.4b9111f6.js"><link rel="prefetch" href="/my-blog/assets/js/11.5d5723d1.js"><link rel="prefetch" href="/my-blog/assets/js/110.7f24fb6a.js"><link rel="prefetch" href="/my-blog/assets/js/111.28300395.js"><link rel="prefetch" href="/my-blog/assets/js/112.839af357.js"><link rel="prefetch" href="/my-blog/assets/js/113.67de001a.js"><link rel="prefetch" href="/my-blog/assets/js/114.408ea2f6.js"><link rel="prefetch" href="/my-blog/assets/js/115.34a1d81a.js"><link rel="prefetch" href="/my-blog/assets/js/116.f510ca2c.js"><link rel="prefetch" href="/my-blog/assets/js/117.24ddf316.js"><link rel="prefetch" href="/my-blog/assets/js/12.06fcb150.js"><link rel="prefetch" href="/my-blog/assets/js/13.c441de9d.js"><link rel="prefetch" href="/my-blog/assets/js/14.ca26e948.js"><link rel="prefetch" href="/my-blog/assets/js/15.e7761bd0.js"><link rel="prefetch" href="/my-blog/assets/js/16.5be4d33f.js"><link rel="prefetch" href="/my-blog/assets/js/17.4426a95c.js"><link rel="prefetch" href="/my-blog/assets/js/18.7d974f8d.js"><link rel="prefetch" href="/my-blog/assets/js/19.775995bc.js"><link rel="prefetch" href="/my-blog/assets/js/20.71c35e12.js"><link rel="prefetch" href="/my-blog/assets/js/21.741a18a7.js"><link rel="prefetch" href="/my-blog/assets/js/22.819a7e85.js"><link rel="prefetch" href="/my-blog/assets/js/23.f9133433.js"><link rel="prefetch" href="/my-blog/assets/js/25.0aa2d6ab.js"><link rel="prefetch" href="/my-blog/assets/js/26.3e55392e.js"><link rel="prefetch" href="/my-blog/assets/js/27.ae2e0581.js"><link rel="prefetch" href="/my-blog/assets/js/28.aaa62b88.js"><link rel="prefetch" href="/my-blog/assets/js/29.55007ae9.js"><link rel="prefetch" href="/my-blog/assets/js/3.57915124.js"><link rel="prefetch" href="/my-blog/assets/js/30.63aac023.js"><link rel="prefetch" href="/my-blog/assets/js/31.d5607214.js"><link rel="prefetch" href="/my-blog/assets/js/32.a7ae912b.js"><link rel="prefetch" href="/my-blog/assets/js/33.58fcbfa4.js"><link rel="prefetch" href="/my-blog/assets/js/34.8538d781.js"><link rel="prefetch" href="/my-blog/assets/js/35.14a82428.js"><link rel="prefetch" href="/my-blog/assets/js/36.2ad806dd.js"><link rel="prefetch" href="/my-blog/assets/js/37.207a29ce.js"><link rel="prefetch" href="/my-blog/assets/js/38.57c0d12e.js"><link rel="prefetch" href="/my-blog/assets/js/39.83aff8a9.js"><link rel="prefetch" href="/my-blog/assets/js/40.bcbcfd03.js"><link rel="prefetch" href="/my-blog/assets/js/41.d0a94dfd.js"><link rel="prefetch" href="/my-blog/assets/js/42.f6011b50.js"><link rel="prefetch" href="/my-blog/assets/js/43.efd29b4c.js"><link rel="prefetch" href="/my-blog/assets/js/44.e5c9709c.js"><link rel="prefetch" href="/my-blog/assets/js/45.7656da3c.js"><link rel="prefetch" href="/my-blog/assets/js/46.0f46c833.js"><link rel="prefetch" href="/my-blog/assets/js/47.40ce4540.js"><link rel="prefetch" href="/my-blog/assets/js/48.3db9c583.js"><link rel="prefetch" href="/my-blog/assets/js/49.53285ac3.js"><link rel="prefetch" href="/my-blog/assets/js/50.4db56f99.js"><link rel="prefetch" href="/my-blog/assets/js/51.188f8c4f.js"><link rel="prefetch" href="/my-blog/assets/js/52.95be221e.js"><link rel="prefetch" href="/my-blog/assets/js/53.276e1791.js"><link rel="prefetch" href="/my-blog/assets/js/54.2fd73796.js"><link rel="prefetch" href="/my-blog/assets/js/55.c90a5bd8.js"><link rel="prefetch" href="/my-blog/assets/js/56.406f89df.js"><link rel="prefetch" href="/my-blog/assets/js/57.811f05ab.js"><link rel="prefetch" href="/my-blog/assets/js/58.e2896a54.js"><link rel="prefetch" href="/my-blog/assets/js/59.e5f3be54.js"><link rel="prefetch" href="/my-blog/assets/js/6.8ba90f8e.js"><link rel="prefetch" href="/my-blog/assets/js/60.e4b67c15.js"><link rel="prefetch" href="/my-blog/assets/js/61.7b772903.js"><link rel="prefetch" href="/my-blog/assets/js/62.bbe4352b.js"><link rel="prefetch" href="/my-blog/assets/js/63.e350ef3b.js"><link rel="prefetch" href="/my-blog/assets/js/64.7b6ca2f6.js"><link rel="prefetch" href="/my-blog/assets/js/65.76baf7fa.js"><link rel="prefetch" href="/my-blog/assets/js/66.ff801cea.js"><link rel="prefetch" href="/my-blog/assets/js/67.ee30cd5b.js"><link rel="prefetch" href="/my-blog/assets/js/68.0f4c1ce2.js"><link rel="prefetch" href="/my-blog/assets/js/69.111ce4de.js"><link rel="prefetch" href="/my-blog/assets/js/7.55078740.js"><link rel="prefetch" href="/my-blog/assets/js/70.46f8b5e8.js"><link rel="prefetch" href="/my-blog/assets/js/71.675e279c.js"><link rel="prefetch" href="/my-blog/assets/js/72.c419d947.js"><link rel="prefetch" href="/my-blog/assets/js/73.6eb4799a.js"><link rel="prefetch" href="/my-blog/assets/js/74.18229d2e.js"><link rel="prefetch" href="/my-blog/assets/js/75.46c8298d.js"><link rel="prefetch" href="/my-blog/assets/js/76.c966d3c5.js"><link rel="prefetch" href="/my-blog/assets/js/77.b31efc9c.js"><link rel="prefetch" href="/my-blog/assets/js/78.f7e57735.js"><link rel="prefetch" href="/my-blog/assets/js/79.e056b5a5.js"><link rel="prefetch" href="/my-blog/assets/js/8.ddecccf2.js"><link rel="prefetch" href="/my-blog/assets/js/80.0fc539d1.js"><link rel="prefetch" href="/my-blog/assets/js/81.2b7f0d10.js"><link rel="prefetch" href="/my-blog/assets/js/82.d3e4b716.js"><link rel="prefetch" href="/my-blog/assets/js/83.3073a1d2.js"><link rel="prefetch" href="/my-blog/assets/js/84.d231aeff.js"><link rel="prefetch" href="/my-blog/assets/js/85.7daed020.js"><link rel="prefetch" href="/my-blog/assets/js/86.0c8d8d8e.js"><link rel="prefetch" href="/my-blog/assets/js/87.c4ba5f03.js"><link rel="prefetch" href="/my-blog/assets/js/88.9a4e0ef6.js"><link rel="prefetch" href="/my-blog/assets/js/89.b7bca56b.js"><link rel="prefetch" href="/my-blog/assets/js/9.7463f385.js"><link rel="prefetch" href="/my-blog/assets/js/90.49ec4345.js"><link rel="prefetch" href="/my-blog/assets/js/91.84cb7a66.js"><link rel="prefetch" href="/my-blog/assets/js/92.cb5ea946.js"><link rel="prefetch" href="/my-blog/assets/js/93.05e2ac79.js"><link rel="prefetch" href="/my-blog/assets/js/94.e60969c0.js"><link rel="prefetch" href="/my-blog/assets/js/95.688af442.js"><link rel="prefetch" href="/my-blog/assets/js/96.aba3a873.js"><link rel="prefetch" href="/my-blog/assets/js/97.ca8196eb.js"><link rel="prefetch" href="/my-blog/assets/js/98.071b3a0f.js"><link rel="prefetch" href="/my-blog/assets/js/99.eca50447.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.67b6080f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><!----> <span class="site-name">林山夕风</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础教程" class="dropdown-title"><span class="title">基础教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/frontend/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/backend/" class="nav-link router-link-active">
  后端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/enjoy3/" class="nav-link">
  进阶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据结构与算法" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/structure/" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/algorithm/" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/leetcode/" class="nav-link">
  LeetCode题解
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计思想" class="dropdown-title"><span class="title">设计思想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/principle/" class="nav-link">
  设计原则
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/pattern/" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/thinking_in_java/" class="nav-link">
  Java编程思想
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/refactoring_improving_the_design_of_existing_code/" class="nav-link">
  重构改善既有代码的设计
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/project/" class="nav-link">
  项目实战
</a></div><div class="nav-item"><a href="/my-blog/article/" class="nav-link">
  零散文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/doomthr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/TanHaoran" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础教程" class="dropdown-title"><span class="title">基础教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/frontend/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/backend/" class="nav-link router-link-active">
  后端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/enjoy3/" class="nav-link">
  进阶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据结构与算法" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/structure/" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/algorithm/" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/leetcode/" class="nav-link">
  LeetCode题解
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计思想" class="dropdown-title"><span class="title">设计思想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/principle/" class="nav-link">
  设计原则
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/pattern/" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/thinking_in_java/" class="nav-link">
  Java编程思想
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/refactoring_improving_the_design_of_existing_code/" class="nav-link">
  重构改善既有代码的设计
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/project/" class="nav-link">
  项目实战
</a></div><div class="nav-item"><a href="/my-blog/article/" class="nav-link">
  零散文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/doomthr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/TanHaoran" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>基础教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-blog/backend/线程基础.html" class="sidebar-link">线程基础</a></li><li><a href="/my-blog/backend/线程之间的共享和协作.html" class="sidebar-link">线程之间的共享和协作</a></li><li><a href="/my-blog/backend/线程的并发工具类.html" class="sidebar-link">线程的并发工具类</a></li><li><a href="/my-blog/backend/原子操作CAS.html" class="sidebar-link">原子操作CAS</a></li><li><a href="/my-blog/backend/显示锁和AQS.html" class="sidebar-link">显示锁和AQS</a></li><li><a href="/my-blog/backend/并发容器.html" class="sidebar-link">并发容器</a></li><li><a href="/my-blog/backend/线程池.html" class="sidebar-link">线程池</a></li><li><a href="/my-blog/backend/并发安全.html" class="sidebar-link">并发安全</a></li><li><a href="/my-blog/backend/JMM和底层实现原理.html" class="sidebar-link">JMM和底层实现原理</a></li><li><a href="/my-blog/backend/Java8新增的并发.html" class="sidebar-link">Java8新增的并发</a></li><li><a href="/my-blog/backend/常见并发面试题.html" class="sidebar-link">常见并发面试题</a></li><li><a href="/my-blog/backend/深入理解JVM内存区域.html" class="sidebar-link">深入理解JVM内存区域</a></li><li><a href="/my-blog/backend/JVM如何创建对象.html" class="sidebar-link">JVM如何创建对象</a></li><li><a href="/my-blog/backend/垃圾回收算法与垃圾回收器.html" class="sidebar-link">垃圾回收算法与垃圾回收器</a></li><li><a href="/my-blog/backend/JVM执行子系统.html" class="sidebar-link">JVM执行子系统</a></li><li><a href="/my-blog/backend/JVM性能优化.html" class="sidebar-link">JVM性能优化</a></li><li><a href="/my-blog/backend/MySQL安装和基础数据类型.html" class="active sidebar-link">MySQL安装和基础数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#二、多实例安装" class="sidebar-link">二、多实例安装</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#三、mysql权限" class="sidebar-link">三、MySQL权限</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#_1、权限粒度" class="sidebar-link">1、权限粒度</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#_2、角色概念" class="sidebar-link">2、角色概念</a></li></ul></li><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#四、mysql数据类型" class="sidebar-link">四、MySQL数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#_1、int-类型" class="sidebar-link">1、INT 类型</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#_2、字符类型" class="sidebar-link">2、字符类型</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#_3、日期类型" class="sidebar-link">3、日期类型</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/MySQL安装和基础数据类型.html#_4、json类型" class="sidebar-link">4、json类型</a></li></ul></li></ul></li><li><a href="/my-blog/backend/MySQL体系架构.html" class="sidebar-link">MySQL体系架构</a></li><li><a href="/my-blog/backend/MySQL锁与事务的分析.html" class="sidebar-link">MySQL锁与事务的分析</a></li><li><a href="/my-blog/backend/MySQL业务设计.html" class="sidebar-link">MySQL业务设计</a></li><li><a href="/my-blog/backend/MySQL慢查询.html" class="sidebar-link">MySQL慢查询</a></li><li><a href="/my-blog/backend/MySQL索引和执行计划.html" class="sidebar-link">MySQL索引和执行计划</a></li><li><a href="/my-blog/backend/MySQL的SQL优化.html" class="sidebar-link">MySQL的SQL优化</a></li><li><a href="/my-blog/backend/Linux基础.html" class="sidebar-link">Linux基础</a></li><li><a href="/my-blog/backend/反射：框架设计的灵魂.html" class="sidebar-link">反射：框架设计的灵魂</a></li><li><a href="/my-blog/backend/Java8新增特性.html" class="sidebar-link">Java8新增特性</a></li><li><a href="/my-blog/backend/MyBatis应用.html" class="sidebar-link">MyBatis应用</a></li><li><a href="/my-blog/backend/MyBatis源码骨架分析.html" class="sidebar-link">MyBatis源码骨架分析</a></li><li><a href="/my-blog/backend/MyBatis源码流程分析.html" class="sidebar-link">MyBatis源码流程分析</a></li><li><a href="/my-blog/backend/消息中间件入门，AMQP与RabbitMQ.html" class="sidebar-link">消息中间件入门，AMQP与RabbitMQ</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="mysql安装和基础数据类型"><a href="#mysql安装和基础数据类型" class="header-anchor">#</a> MySQL安装和基础数据类型</h1> <div><span id="/my-blog/backend/MySQL安装和基础数据类型.html" data-flag-title="MySQL安装和基础数据类型" class="leancloud_visitors read-count"><em class="post-meta-item-text">阅读量 </em> <i class="leancloud-visitors-count">loading</i></span> <div class="clear-both"></div></div> <h1 id="一，安装"><a href="#一，安装" class="header-anchor">#</a> 一，安装</h1> <p>这里介绍在 <code>Linux</code> 下的安装。</p> <p>首先去官网下载 <code>MySQL</code> 的压缩包，官网地址 <a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener noreferrer">https://downloads.mysql.com/archives/community/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，将下载好的 <code>MySQL</code> 安装包解压到 <code>/usr/local</code> 目录下，我这里使用的是 <code>mysql-5.7.9-linux-glibc2.5-x86_64.tar.gz</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">tar</span> -zxvf mysql-5.7.9-linux-glibc2.5-x86_64.tar.gz -C /usr/local
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>进入刚才解压好的目录，可以看到有这么一个文件 <code>INSTALL-BINARY</code> ，这个其实就是 <code>MySQL</code> 的安装文档。下面根据这个安装文档进行操作安装：</p> <h3 id="_1、安装依赖"><a href="#_1、安装依赖" class="header-anchor">#</a> 1、安装依赖</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>yum <span class="token function">install</span> -y libaio
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2、添加组"><a href="#_2、添加组" class="header-anchor">#</a> 2、添加组</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">groupadd</span> mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3、添加用户"><a href="#_3、添加用户" class="header-anchor">#</a> 3、添加用户</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">useradd</span> -r -g mysql mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4、创建软连接"><a href="#_4、创建软连接" class="header-anchor">#</a> 4、创建软连接</h3> <p>进入 <code>/usr/local</code> 目录下</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">ln</span> -s /usr/local/mysql-5.7.9-linux-glibc2.5-x86_64/ mysql
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_5、创建目录"><a href="#_5、创建目录" class="header-anchor">#</a> 5、创建目录</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> mysql-files
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_6、授权"><a href="#_6、授权" class="header-anchor">#</a> 6、授权</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">chmod</span> <span class="token number">770</span> mysql-files
<span class="token function">chown</span> -R mysql <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_7、切换组"><a href="#_7、切换组" class="header-anchor">#</a> 7、切换组</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">chgrp</span> -R mysql <span class="token builtin class-name">.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_8、初始化"><a href="#_8、初始化" class="header-anchor">#</a> 8、初始化</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>bin/mysqld --initialize --user<span class="token operator">=</span>mysql
bin/mysql_ssl_rsa_setup <span class="token comment"># 这行命令会产生一个临时密码，注意记录，方便后面修改密码</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_9、继续授权"><a href="#_9、继续授权" class="header-anchor">#</a> 9、继续授权</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">chown</span> -R root <span class="token builtin class-name">.</span>
<span class="token function">chown</span> -R mysql data mysql-files <span class="token comment"># 此时如果提示没有data文件夹就需要先创建一下，再执行这个命令</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>此时，进入目录 <code>data</code>，如果发现目录里面有数据，就说明初始化成功了</p> <h3 id="_10、启动"><a href="#_10、启动" class="header-anchor">#</a> 10、启动</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>bin/mysqld_safe --user<span class="token operator">=</span>mysql <span class="token operator">&amp;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在这一步启动可能会报错，提示没有权限，此时就是读取配置文件 <code>my.cnf</code> 错误的问题。使用命令 <code>/usr/local/mysql/bin/mysqld --verbose --help | grep -A 1 'Default options'</code> 可以查看配置文件的优先读取顺序。执行后可以看到顺序如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Default options are <span class="token builtin class-name">read</span> from the following files <span class="token keyword">in</span> the given order:
/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>有可能这一步还是没法找到配置文件，那么去 <code>/usr/local/mysql/support-files/</code> 下找找是否有一个 <code>my-default.cnf</code> 文件，将这个文件复制到 <code>/etc</code> 下，并重命名为 <code>my.cnf</code>。</p> <h3 id="_11、查看是否启动成功"><a href="#_11、查看是否启动成功" class="header-anchor">#</a> 11、查看是否启动成功</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> mysqld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>出现如下：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>root     <span class="token number">20528</span> <span class="token number">17748</span>  <span class="token number">0</span> <span class="token number">23</span>:05 pts/0    00:00:00 /bin/sh bin/mysqld_safe --user<span class="token operator">=</span>mysql
mysql    <span class="token number">20610</span> <span class="token number">20528</span>  <span class="token number">0</span> <span class="token number">23</span>:05 pts/0    00:00:00 /usr/local/mysql/bin/mysqld --basedir<span class="token operator">=</span>/usr/local/mysql --datadir<span class="token operator">=</span>/usr/local/mysql/data --plugin-dir<span class="token operator">=</span>/usr/local/mysql/lib/plugin --user<span class="token operator">=</span>mysql --log-error<span class="token operator">=</span>/usr/local/mysql/data/yjtravel-bring.err --pid-file<span class="token operator">=</span>/usr/local/mysql/data/yjtravel-bring.pid
root     <span class="token number">21277</span> <span class="token number">17748</span>  <span class="token number">0</span> <span class="token number">23</span>:15 pts/0    00:00:00 <span class="token function">grep</span> --color<span class="token operator">=</span>auto mysqld
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>说明启动成功了</p> <h3 id="_12、配置服务默认开启"><a href="#_12、配置服务默认开启" class="header-anchor">#</a> 12、配置服务默认开启</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> support-files/mysql.server /etc/init.d/mysql.server
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_13、查看目前配置的开机启动的程序"><a href="#_13、查看目前配置的开机启动的程序" class="header-anchor">#</a> 13、查看目前配置的开机启动的程序</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">chkconfig</span> --list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_14、配置开机启动"><a href="#_14、配置开机启动" class="header-anchor">#</a> 14、配置开机启动</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">chkconfig</span> mysql.server on
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_15、配置环境变量"><a href="#_15、配置环境变量" class="header-anchor">#</a> 15、配置环境变量</h3> <p>编辑文件 <code>/etc/profile</code>，给文件末尾添加：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span>/usr/local/mysql/bin:<span class="token environment constant">$PATH</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>刷新配置文件：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">source</span> /etc/profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_16、测试连接"><a href="#_16、测试连接" class="header-anchor">#</a> 16、测试连接</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>mysql -uroot -p<span class="token string">'MaZI.yGp*2Su'</span> <span class="token comment"># 刚才安装时生成的密码</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_17、连接成功后，修改密码，配置允许远程连接"><a href="#_17、连接成功后，修改密码，配置允许远程连接" class="header-anchor">#</a> 17、连接成功后，修改密码，配置允许远程连接</h3> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">set</span> password <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><code>%</code> 表示所有 <code>ip</code></p> <h3 id="_18、重启mysql"><a href="#_18、重启mysql" class="header-anchor">#</a> 18、重启mysql</h3> <p>先停止服务，然后再启动服务即可。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>/etc/inint.d/mysql stop
/etc/inint.d/mysql start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="二、多实例安装"><a href="#二、多实例安装" class="header-anchor">#</a> 二、多实例安装</h2> <p>首先修改配置文件如下：</p> <div class="language-cnf line-numbers-mode"><pre class="language-text"><code>[mysqld]
sql_mode=&quot;STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION,NO_ZERO_DATE,NO_ZERO_IN_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER&quot;

[mysqld_multi]
mysqld=/usr/local/mysql/bin/mysqld_safe
mysqladmin=/usr/local/mysql/bin/mysqladmin
log=/var/log/mysqld_multi.log

[mysqld1]
server-id=11
socket=/tmp/mysql.sock1
port=3307
datadir=/usr/local/mysql/data1
user=mysql
performance_schema=off
innodb_buffer_pool_size=32M
skip_name_resolve=1
log_error=error.log
pid-file=/usr/local/mysql/data1/mysql.pid1

[mysqld2]
server-id=12
socket=/tmp/mysql.sock2
port=3308
datadir=/usr/local/mysql/data2
user=mysql
performance_schema=off
innodb_buffer_pool_size=32M
skip_name_resolve=1
log_error=error.log
pid-file=/usr/local/mysql/data2/mysql.pid2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>在 <code>/usr/local/mysql</code> 目录下创建 <code>data1</code> 和 <code>data2</code>目录。并给予权限 <code>chown mysql.mysql /usr/local/mysql/data1</code> 和 <code>chown mysql.mysql /usr/local/mysql/data2</code></p> <p>接下来初始化；</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>mysqld --initialize --user<span class="token operator">=</span>mysql --datadir<span class="token operator">=</span>/usr/local/mysql/data1
mysqld --initialize --user<span class="token operator">=</span>mysql --datadir<span class="token operator">=</span>/usr/local/mysql/data2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>同时不要忘记记录两个实例生成的密码。</p> <p>接来下配置开机启动：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cp</span> /usr/local/mysql/support-files/mysqld_multi.server /etc/init.d/mysqld_multid
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后修改 <code>mysqld_multid</code> 文件，在文件顶部加入环境变量：<code>export PATH=$PATH:/usr/local/mysql/bin</code></p> <p>然后再执行：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">chkconfig</span> mysqld_multid on
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>启动多实例：<code>mysqld_multi start</code></p> <p>查看启动状态：<code>mysqld_multi report</code>，如果现实两个服务器都是 <code>running</code> 状态就说明成功了，如果不是 <code>running</code> 状态的话，可以去 <code>/data1</code> 或者 <code>/data2</code> 目录下查看下错误的日志信息，日志存放在 <code>error.log</code> 文件中。</p> <p>至此，多实例的安装和启动就已经完成了，这个多实例和之前的单实例互相独立，互不影响。</p> <p>接下来服务器登录两个实例进行修改密码和允许远程访问：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>mysql -u root -S /tmp/mysql.sock1 -p -P3307
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">set</span> password <span class="token operator">=</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> <span class="token operator">*</span><span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'root'</span><span class="token variable">@'%'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'123456'</span><span class="token punctuation">;</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>然后重复这个操作对第二个实例进行操作。</p> <h2 id="三、mysql权限"><a href="#三、mysql权限" class="header-anchor">#</a> 三、MySQL权限</h2> <p>使用 <code>root</code> 用户通过工具远程登录，创建数据库 <code>mall</code>,给用户 <code>dev</code> 授予查询 <code>mall</code> 数据库的权限：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span> <span class="token keyword">ON</span> mall<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'dev'</span><span class="token variable">@'%'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'123456'</span><span class="token punctuation">;</span> <span class="token comment"># 这个密码可以和root用户的密码不一致</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在执行这条语句的时候可能会提示 <code>Access denied for user 'root'@'%' to database 'mall'</code>，这是由于多个 <code>root</code> 用户在登录的时候产生了多个进程，所以在开始给 <code>root</code> 用户授权的时候系统并不知道具体给哪个 <code>root</code> 授权，此时需要将所有<code>root</code> 相关进程进行结束，命令如下：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> concat<span class="token punctuation">(</span><span class="token string">'KILL '</span><span class="token punctuation">,</span>id<span class="token punctuation">,</span><span class="token string">';'</span><span class="token punctuation">)</span> <span class="token keyword">FROM</span> information_schema<span class="token punctuation">.</span>processlist <span class="token keyword">WHERE</span> <span class="token keyword">user</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后重新登录授权就没问题了。
具体原因可以查看这篇帖子：<a href="https://blog.csdn.net/gu_wen_jie/article/details/89242255" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/gu_wen_jie/article/details/89242255<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>查看 <code>dev</code> 用户目前的权限：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SHOW</span> GRANTS <span class="token keyword">FOR</span> <span class="token string">'dev'</span><span class="token variable">@'%'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_1、权限粒度"><a href="#_1、权限粒度" class="header-anchor">#</a> 1、权限粒度</h3> <p>其实在 <code>MySQL</code> 中，权限是可以精确到字段级别的。</p> <p>创建表语句：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>account<span class="token punctuation">`</span> <span class="token punctuation">(</span>
	<span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>name<span class="token punctuation">`</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token punctuation">`</span>balance<span class="token punctuation">`</span> <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
	<span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">KEY</span> <span class="token punctuation">`</span>idx_balance<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>balance<span class="token punctuation">`</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">INNODB</span> <span class="token keyword">DEFAULT</span> <span class="token keyword">CHARSET</span><span class="token operator">=</span>UTF8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>随便插入几条数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> <span class="token punctuation">`</span>account<span class="token punctuation">`</span> <span class="token keyword">VALUE</span> <span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token string">'lilei'</span><span class="token punctuation">,</span> <span class="token string">'900'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token punctuation">`</span>account<span class="token punctuation">`</span> <span class="token keyword">VALUE</span> <span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token string">'hanmei'</span><span class="token punctuation">,</span> <span class="token string">'100'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token punctuation">`</span>account<span class="token punctuation">`</span> <span class="token keyword">VALUE</span> <span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token string">'lucy'</span><span class="token punctuation">,</span> <span class="token string">'250'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token punctuation">`</span>account<span class="token punctuation">`</span> <span class="token keyword">VALUE</span> <span class="token punctuation">(</span><span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token string">'tom'</span><span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><code>mysql</code> 库中的 <code>user</code> 表存储了 <code>用户+ip</code> 所对应的权限。<code>db</code> 表存储了用户对库所具有的权限。<code>tables_priv</code> 和 <code>columns_priv</code> 可以控制表和列级别的权限。</p> <p>移除给用户分配的权限：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">REVOKE</span> <span class="token keyword">SELECT</span> <span class="token keyword">ON</span> mall<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> <span class="token string">'dev'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>只给用户分配指定字段的查询权限：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token keyword">ON</span> mall<span class="token punctuation">.</span>account <span class="token keyword">to</span> <span class="token string">'dev'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span> <span class="token comment"># 只能访问id和name字段</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此时使用 <code>dev</code> 用户登录就只能访问 <code>mall</code> 数据库的 <code>id</code> 和 <code>name</code> 字段了。</p> <h3 id="_2、角色概念"><a href="#_2、角色概念" class="header-anchor">#</a> 2、角色概念</h3> <p>在 <code>MySQL</code> 中是没有明确的角色概念的，但是可以将用户理解成为一个角色的概念。</p> <p>设置开启角色功能和密码加密：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> check_proxy_users <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">SET</span> <span class="token keyword">GLOBAL</span> mysql_native_password_proxy_users <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>创建用户（理解成角色）</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">'dev_role'</span><span class="token punctuation">;</span> <span class="token comment">// 看成是角色</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">'deer'</span><span class="token punctuation">;</span> <span class="token comment">// 看成是用户</span>
<span class="token keyword">CREATE</span> <span class="token keyword">USER</span> <span class="token string">'enjoy'</span><span class="token punctuation">;</span> <span class="token comment">// 看成是用户</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>此时需要给 <code>root</code> 用户授权的权限，需要在 <code>MySQL</code> 控制台进行授权，然后在进行授权。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">GRANT</span> PROXY <span class="token keyword">ON</span> <span class="token string">''</span>@'<span class="token string">' TO '</span>root<span class="token string">'@'</span><span class="token operator">%</span><span class="token string">';
GRANT PROXY ON '</span>dev_role<span class="token string">' to '</span>deer<span class="token string">';
GRANT PROXY ON '</span>dev_role<span class="token string">' to '</span>enjoy'<span class="token punctuation">;</span>
flush <span class="token keyword">privileges</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这时只要给 <code>dev_role</code> 角色授权，另外两个用户就自动有权限了。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">GRANT</span> <span class="token keyword">SELECT</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">)</span> <span class="token keyword">ON</span> mall<span class="token punctuation">.</span>account <span class="token keyword">to</span> <span class="token string">'dev_role'</span><span class="token variable">@'%'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这时使用 <code>deer</code> 和空密码进行登录，可以查询到 <code>account</code> 表的 <code>id</code> 和 <code>name</code> 字段了。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> id<span class="token punctuation">,</span> name <span class="token keyword">FROM</span> account<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在 <code>proxies_priv</code> 表中可以看到刚才给用户授予角色的信息。</p> <h2 id="四、mysql数据类型"><a href="#四、mysql数据类型" class="header-anchor">#</a> 四、MySQL数据类型</h2> <h3 id="_1、int-类型"><a href="#_1、int-类型" class="header-anchor">#</a> 1、INT 类型</h3> <table><thead><tr><th>类型</th> <th>字节</th> <th>最小值</th> <th>最大值</th></tr></thead> <tbody><tr><td>有符号 TINYINT</td> <td>1</td> <td>-128</td> <td>127</td></tr> <tr><td>无符号 TINYINT</td> <td>1</td> <td>0</td> <td>255</td></tr> <tr><td>有符号 SMALLINT</td> <td>2</td> <td>-32768</td> <td>32767</td></tr> <tr><td>无符号 SMALLINT</td> <td>2</td> <td>0</td> <td>65535</td></tr> <tr><td>有符号 MEDIUMINT</td> <td>3</td> <td>-8388608</td> <td>8388607</td></tr> <tr><td>无符号 MEDIUMINT</td> <td>3</td> <td>0</td> <td>16777215</td></tr> <tr><td>有符号 BIGINT</td> <td>8</td> <td>-92233720368547758080</td> <td>92233720368547758087</td></tr> <tr><td>无符号 BIGINT</td> <td>8</td> <td>0</td> <td>18446744073709551615</td></tr></tbody></table> <p>创建个无符号表，并插入数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_unsigned <span class="token punctuation">(</span>a <span class="token keyword">INT</span> <span class="token keyword">UNSIGNED</span><span class="token punctuation">,</span> b <span class="token keyword">INT</span> <span class="token keyword">UNSIGNED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> test_unsigned <span class="token keyword">VALUE</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>做如下查询：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> b <span class="token operator">-</span> a <span class="token keyword">FROM</span> test_unsigned<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以正常查询，再做如下查询：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> a <span class="token operator">-</span> b <span class="token keyword">FROM</span> test_unsigned<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以发现查询结果是null或者报错了，因为超出了最大精度。</p> <p>创建表并插入数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_int_n<span class="token punctuation">(</span>a <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> ZEROFILL<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> test_int_n <span class="token keyword">VALUE</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> test_int_n <span class="token keyword">VALUE</span><span class="token punctuation">(</span><span class="token number">123456</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这个<code>INT(4)</code> 表示如果没有达到长度位数4，会在前面补零。</p> <p>此时使用终端进行查询：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_int_n<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>就会发现显示结果是：</p> <div class="language-console line-numbers-mode"><pre class="language-text"><code>+--------+
| a      |
+--------+
|   0001 |
| 123456 |
+--------+
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>要想创建逐渐自动增长的表，一定要指明主键：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_auto_increment<span class="token punctuation">(</span>a <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>插入数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> test_auto_increment <span class="token keyword">VALUES</span><span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token boolean">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查询：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_auto_increment<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果：</p> <div class="language-console line-numbers-mode"><pre class="language-text"><code>1
10
100
101
102
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>再插入一条数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> test_auto_increment <span class="token keyword">VALUE</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查询</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_auto_increment<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果：</p> <div class="language-console line-numbers-mode"><pre class="language-text"><code>-3
-1
1
10
100
101
102
104
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_2、字符类型"><a href="#_2、字符类型" class="header-anchor">#</a> 2、字符类型</h3> <table><thead><tr><th>类型</th> <th>说明</th> <th>N的含义</th> <th>是否有字符集</th> <th>最大长度</th></tr></thead> <tbody><tr><td>CHAR(N)</td> <td>定长字符</td> <td>字符</td> <td>是</td> <td>255</td></tr> <tr><td>VARCHAR(N)</td> <td>变长字符</td> <td>字符</td> <td>是</td> <td>16348</td></tr> <tr><td>BINARY(N)</td> <td>定长二进制字节</td> <td>字节</td> <td>否</td> <td>255</td></tr> <tr><td>VARBINARY(N)</td> <td>变长二进制字节</td> <td>字节</td> <td>是</td> <td>16348</td></tr> <tr><td>TINYBLOB(N)</td> <td>二进制大对象</td> <td>字节</td> <td>是</td> <td>256</td></tr> <tr><td>BLOB(N)</td> <td>二进制大对象</td> <td>字节</td> <td>是</td> <td>16K</td></tr> <tr><td>MEDIUMBLOB(N)</td> <td>二进制大对象</td> <td>字节</td> <td>是</td> <td>255</td></tr> <tr><td>LONGBLOB(N)</td> <td>二进制大对象</td> <td>字节</td> <td>否</td> <td>4G</td></tr> <tr><td>TINYTEXT(N)</td> <td>大对象</td> <td>字节</td> <td>是</td> <td>256</td></tr> <tr><td>TEXT(N)</td> <td>大对象</td> <td>字节</td> <td>是</td> <td>16K</td></tr> <tr><td>MEDIUMTEXT(N)</td> <td>大对象</td> <td>字节</td> <td>是</td> <td>16M</td></tr> <tr><td>LONGTEXT(N)</td> <td>大对象</td> <td>字节</td> <td>是</td> <td>4G</td></tr></tbody></table> <p>除了 <code>CHAR</code> 和 <code>VARCHAR</code> 保存的是字符，其它保存的都是字节</p> <p>默认情况下，当数据库的排序规则是 <code>utf8_general_ci</code> 的时候：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token string">'a'</span> <span class="token operator">=</span> <span class="token string">'A'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行的结果是：</p> <div class="language-console line-numbers-mode"><pre class="language-text"><code>1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>utf8_general_ci</code> 排序规则会忽略大小写，而 <code>utf8_bin</code> 排序规则不会忽略大小写。</p> <p>修改数据库的排序规则：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> NAMES utf8mb4 <span class="token keyword">COLLATE</span> utf8mb4_bin<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>此时再执行：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token string">'a'</span> <span class="token operator">=</span> <span class="token string">'A'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行的结果是：</p> <div class="language-console line-numbers-mode"><pre class="language-text"><code>0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3、日期类型"><a href="#_3、日期类型" class="header-anchor">#</a> 3、日期类型</h3> <table><thead><tr><th>日期类型</th> <th>占用空间</th> <th>表示范围</th> <th></th></tr></thead> <tbody><tr><td>DATETIME</td> <td>8</td> <td>1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</td> <td></td></tr> <tr><td>DATE</td> <td>3</td> <td>1000-01-01 ~ 9999-12-31</td> <td></td></tr> <tr><td>TIMESTAMP</td> <td>4</td> <td>1970-01-01 00:00:00UTC ~ 2038-01-19 03:14:07UTC</td> <td></td></tr> <tr><td>YEAR</td> <td>1</td> <td>YEAR(2):1970-2070, YEAR(4):1901-2155</td> <td></td></tr> <tr><td>TIME</td> <td>3</td> <td>-838:59:59 ~ 838:59:59</td> <td></td></tr></tbody></table> <p>创建表，添加数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_time<span class="token punctuation">(</span>a <span class="token keyword">TIMESTAMP</span><span class="token punctuation">,</span> b <span class="token keyword">DATETIME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">INSERT</span> test_time <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">SELECT</span> @<span class="token variable">@time_zone</span><span class="token punctuation">;</span>

<span class="token keyword">SET</span> time_zone <span class="token operator">=</span> <span class="token string">'+00:00'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>此时查询：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_time<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果：</p> <div class="language-console line-numbers-mode"><pre class="language-text"><code>2020-04-19 22:25:00	2020-04-19 22:25:00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果修改了时区：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> time_zone <span class="token operator">=</span> <span class="token string">'+00:00'</span><span class="token punctuation">;</span>
<span class="token comment"># 查询时区可以用这个</span>
<span class="token keyword">SET</span> time_zone <span class="token operator">=</span> <span class="token string">'+00:00'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>此时查询：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> test_time<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果：</p> <div class="language-console line-numbers-mode"><pre class="language-text"><code>2020-04-19 14:25:00	2020-04-19 22:25:00
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>发现时间不一样了，这说明 <code>TIMESTAMP</code> 类型是带有时区信息的，而 <code>DATETIME</code> 没有时区信息。</p> <h3 id="_4、json类型"><a href="#_4、json类型" class="header-anchor">#</a> 4、json类型</h3> <p><code>json</code> 数据类型是从 <code>mysql</code> 5.7才引入的类型。</p> <p>创建表：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> json_user <span class="token punctuation">(</span> uid <span class="token keyword">INT</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span> <span class="token keyword">data</span> json<span class="token punctuation">,</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span> uid <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>插入数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> json_user
<span class="token keyword">VALUES</span>
	<span class="token punctuation">(</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'{ &quot;name&quot;:&quot;lison&quot;, &quot;age&quot;:18, &quot;address&quot;:&quot;enjoy&quot;
	}'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> json_user
<span class="token keyword">VALUES</span>
	<span class="token punctuation">(</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> <span class="token string">'{&quot;name&quot;:&quot;james&quot;, &quot;age&quot;:28, &quot;mail&quot;:&quot;james@163.com&quot;
	}'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这里如果 <code>json</code> 格式有问题，是无法插入成功的。</p> <h4 id="_1-常用函数"><a href="#_1-常用函数" class="header-anchor">#</a> (1) 常用函数</h4> <h5 id="json-extract-抽取"><a href="#json-extract-抽取" class="header-anchor">#</a> json_extract 抽取</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>	json_extract <span class="token punctuation">(</span> <span class="token string">'[10, 20, [30, 40]]'</span><span class="token punctuation">,</span> <span class="token string">'$[1]'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行结果是：<code>20</code></p> <p>如果想要查询 <code>json_user</code> 表中 <code>data</code> 字段 <code>json</code> 的 <code>name</code> 列和 <code>address</code> 列，可以这么写：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	json_extract <span class="token punctuation">(</span> <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">'$.name'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
	json_extract <span class="token punctuation">(</span> <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">'$.address'</span> <span class="token punctuation">)</span> 
<span class="token keyword">FROM</span>
	json_user<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="json-object-对象转json"><a href="#json-object-对象转json" class="header-anchor">#</a> json_object 对象转json</h5> <p>这个函数会将给定的参数两两匹配，组成一个 <code>json</code> 对象。</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>	json_object <span class="token punctuation">(</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;enjoy&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;enjoy.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token number">35</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行结果是：<code>{&quot;age&quot;: 35, &quot;name&quot;: &quot;enjoy&quot;, &quot;email&quot;: &quot;enjoy.com&quot;}</code></p> <p>给 <code>json_user</code> 表添加数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> json_user 
<span class="token keyword">VALUE</span>
	<span class="token punctuation">(</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span> json_object <span class="token punctuation">(</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;enjoy&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;email&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;enjoy.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;age&quot;</span><span class="token punctuation">,</span> <span class="token number">35</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="json-insert-插入数据"><a href="#json-insert-插入数据" class="header-anchor">#</a> json_insert 插入数据</h5> <p>首先讲一个知识点。<code>@</code> 和 <code>@@</code>，前者是查询局部变量的，后者是查询全局变量的。</p> <p>例如 <code>SHOW VARIABLES LIKE '%datadir%';</code> 可以查询存放数据的目录，同样使用 <code>SELECT @@datadir;</code> 也可以完成同样的效果。</p> <p>那么此时设置一个局部变量：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SET</span> <span class="token variable">@json</span> <span class="token operator">=</span> <span class="token string">'{ &quot;a&quot;: 1, &quot;b&quot;: [2, 3]}'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>然后：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>	json_insert <span class="token punctuation">(</span> <span class="token variable">@json</span><span class="token punctuation">,</span> <span class="token string">'$.a'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'$.c'</span><span class="token punctuation">,</span> <span class="token string">'[true, false]'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行结果是：<code>{&quot;a&quot;: 1, &quot;b&quot;: [2, 3], &quot;c&quot;: &quot;[true, false]&quot;}</code>。</p> <p>因为原本的 <code>@json</code> 中，<code>a</code> 字段已经有值了，所以插入的时候10是不能插入成功的，而字段 <code>c</code> 因为在原本的 <code>json</code> 中不存在，所以可以将 <code>c</code> 字段追加插入到 <code>json</code> 中。</p> <p>看下面这个语句：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">UPDATE</span> json_user 
<span class="token keyword">SET</span> <span class="token keyword">data</span> <span class="token operator">=</span> json_insert <span class="token punctuation">(</span> <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">&quot;$.address_2&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;xiangxue&quot;</span> <span class="token punctuation">)</span> 
<span class="token keyword">WHERE</span>
	uid <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>这个就给原来 <code>data</code> 字段的 <code>json</code> 中新增了一个 <code>address_2</code> 字段，并且值是 <code>xiangxue</code></p> <h5 id="json-merge-合并数据并返回"><a href="#json-merge-合并数据并返回" class="header-anchor">#</a> json_merge 合并数据并返回</h5> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>	json_merge <span class="token punctuation">(</span> <span class="token string">'{&quot;name&quot;: &quot;enjoy&quot;}'</span><span class="token punctuation">,</span> <span class="token string">'{&quot;id&quot;: 47}'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>执行结果：<code>{&quot;id&quot;: 47, &quot;name&quot;: &quot;enjoy&quot;}</code></p> <p>那么语句：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	json_merge <span class="token punctuation">(</span> json_extract <span class="token punctuation">(</span> <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">'$.address'</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> json_extract <span class="token punctuation">(</span> <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">'$.address_2'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span> 
<span class="token keyword">FROM</span>
	json_user 
<span class="token keyword">WHERE</span>
	uid <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>的意思就是将 <code>data</code> 字段 <code>json</code> 中的 <code>address</code> 和 <code>address2</code> 字段进行合并并返回。</p> <p>结果：<code>[&quot;enjoy&quot;, &quot;xiangxue&quot;]</code></p> <p>其它关于 <code>json</code> 的更多函数可以在官网查询：<a href="https://dev.mysql.com/doc/refman/5.7/en/json-function-reference.html" target="_blank" rel="noopener noreferrer">https://dev.mysql.com/doc/refman/5.7/en/json-function-reference.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h4 id="_2-json索引"><a href="#_2-json索引" class="header-anchor">#</a> (2) json索引</h4> <p><code>json</code> 类型数据本身无法直接创建索引，需要将需要索引的 <code>json</code> 数据重新生成虚拟列(<code>Virtual Columns</code>)之后，对该列进行索引。</p> <p>创建表：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_index_1 <span class="token punctuation">(</span> 
<span class="token keyword">data</span> json<span class="token punctuation">,</span> 
gen_col <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span> <span class="token number">10</span> <span class="token punctuation">)</span> generated always <span class="token keyword">AS</span> <span class="token punctuation">(</span> json_extract <span class="token punctuation">(</span> <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">'$.name'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> 
<span class="token keyword">INDEX</span> idx <span class="token punctuation">(</span> gen_col <span class="token punctuation">)</span> 
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这个语句创建的表有2个字段，一个字段是 <code>data</code>，另一个字段 <code>gen_col</code> 的值是来自 <code>data</code> 字段中 <code>name</code> 字段的值。</p> <p>插入数据：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">INSERT</span> test_index_1 <span class="token punctuation">(</span> <span class="token keyword">data</span> <span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
	<span class="token punctuation">(</span> <span class="token string">'{&quot;name&quot;:&quot;king&quot;, &quot;age&quot;:18, &quot;address&quot;:&quot;cs&quot;}'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> test_index_1 <span class="token punctuation">(</span> <span class="token keyword">DATA</span> <span class="token punctuation">)</span>
<span class="token keyword">VALUES</span>
	<span class="token punctuation">(</span> <span class="token string">'{&quot;name&quot;:&quot;peter&quot;, &quot;age&quot;:28, &quot;address&quot;:&quot;zz&quot;}'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>查询即可看到 <code>gen_col</code> 字段就有了值。</p> <p>于是，也就可以实现 <code>where</code> 语句的查询功能：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	json_extract <span class="token punctuation">(</span> <span class="token keyword">data</span><span class="token punctuation">,</span> <span class="token string">&quot;$.name&quot;</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> username 
<span class="token keyword">FROM</span>
	test_index_1 
<span class="token keyword">WHERE</span>
	gen_col <span class="token operator">=</span> <span class="token string">'&quot;king&quot;'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>注意，这里生成的 <code>gen_col</code> 列的值是带有 <code>&quot;</code> 的，查询的时候不要忘记了。但是这样似乎有些麻烦，有什么办法可以让查询的时候不用输入 <code>&quot;</code> 呢？</p> <p>只需要在创建的时候使用如下语句：</p> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> test_index_2 <span class="token punctuation">(</span>
	 <span class="token keyword">data</span> json<span class="token punctuation">,</span> 
	 gen_col <span class="token keyword">VARCHAR</span> <span class="token punctuation">(</span> <span class="token number">10</span> <span class="token punctuation">)</span> generated always <span class="token keyword">AS</span> <span class="token punctuation">(</span> json_unquote<span class="token punctuation">(</span> json_extract<span class="token punctuation">(</span> <span class="token keyword">DATA</span><span class="token punctuation">,</span> <span class="token string">&quot;$.name&quot;</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> 
	 <span class="token keyword">INDEX</span> idx <span class="token punctuation">(</span> gen_col <span class="token punctuation">)</span> 
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>这里使用到了 <code>json_unquote()</code> 函数，它将 <code>&quot;</code> 去掉了。</p> <div><br> <div id="vcomments"></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020-08-21 09:02:51（10 小时前）</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/my-blog/backend/JVM性能优化.html" class="prev">
        JVM性能优化
      </a></span> <span class="next"><a href="/my-blog/backend/MySQL体系架构.html">
        MySQL体系架构
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-blog/assets/js/app.11c55fdf.js" defer></script><script src="/my-blog/assets/js/2.f643b0a2.js" defer></script><script src="/my-blog/assets/js/24.86a7d541.js" defer></script><script src="/my-blog/assets/js/4.fd36f240.js" defer></script><script src="/my-blog/assets/js/5.628d6842.js" defer></script>
  </body>
</html>
