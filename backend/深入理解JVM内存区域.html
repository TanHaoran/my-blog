<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>深入理解JVM内存区域 | 林山夕风</title>
    <meta name="description" content="林山夕风的博客,md文档,技术博客">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/my-blog/avatar.jpg">
  <script>
                var _hmt = _hmt || [];
                (function() {
                    var hm = document.createElement("script");
                    hm.src = "https://hm.baidu.com/hm.js?68e7a949df184c1e4c82b115461e51e0";
                    var s = document.getElementsByTagName("script")[0];
                    s.parentNode.insertBefore(hm, s);
                })();
            </script>
    
    <link rel="preload" href="/my-blog/assets/css/0.styles.67b6080f.css" as="style"><link rel="preload" href="/my-blog/assets/js/app.11c55fdf.js" as="script"><link rel="preload" href="/my-blog/assets/js/2.f643b0a2.js" as="script"><link rel="preload" href="/my-blog/assets/js/38.57c0d12e.js" as="script"><link rel="preload" href="/my-blog/assets/js/4.fd36f240.js" as="script"><link rel="preload" href="/my-blog/assets/js/5.628d6842.js" as="script"><link rel="prefetch" href="/my-blog/assets/js/10.f4eaa613.js"><link rel="prefetch" href="/my-blog/assets/js/100.07e38629.js"><link rel="prefetch" href="/my-blog/assets/js/101.dcfe2bf2.js"><link rel="prefetch" href="/my-blog/assets/js/102.209999b3.js"><link rel="prefetch" href="/my-blog/assets/js/103.a9a85d34.js"><link rel="prefetch" href="/my-blog/assets/js/104.fdefe1dc.js"><link rel="prefetch" href="/my-blog/assets/js/105.e4b5d0af.js"><link rel="prefetch" href="/my-blog/assets/js/106.cf83f84b.js"><link rel="prefetch" href="/my-blog/assets/js/107.848b42d5.js"><link rel="prefetch" href="/my-blog/assets/js/108.351fb64c.js"><link rel="prefetch" href="/my-blog/assets/js/109.4b9111f6.js"><link rel="prefetch" href="/my-blog/assets/js/11.5d5723d1.js"><link rel="prefetch" href="/my-blog/assets/js/110.7f24fb6a.js"><link rel="prefetch" href="/my-blog/assets/js/111.28300395.js"><link rel="prefetch" href="/my-blog/assets/js/112.839af357.js"><link rel="prefetch" href="/my-blog/assets/js/113.67de001a.js"><link rel="prefetch" href="/my-blog/assets/js/114.408ea2f6.js"><link rel="prefetch" href="/my-blog/assets/js/115.34a1d81a.js"><link rel="prefetch" href="/my-blog/assets/js/116.f510ca2c.js"><link rel="prefetch" href="/my-blog/assets/js/117.24ddf316.js"><link rel="prefetch" href="/my-blog/assets/js/12.06fcb150.js"><link rel="prefetch" href="/my-blog/assets/js/13.c441de9d.js"><link rel="prefetch" href="/my-blog/assets/js/14.ca26e948.js"><link rel="prefetch" href="/my-blog/assets/js/15.e7761bd0.js"><link rel="prefetch" href="/my-blog/assets/js/16.5be4d33f.js"><link rel="prefetch" href="/my-blog/assets/js/17.4426a95c.js"><link rel="prefetch" href="/my-blog/assets/js/18.7d974f8d.js"><link rel="prefetch" href="/my-blog/assets/js/19.775995bc.js"><link rel="prefetch" href="/my-blog/assets/js/20.71c35e12.js"><link rel="prefetch" href="/my-blog/assets/js/21.741a18a7.js"><link rel="prefetch" href="/my-blog/assets/js/22.819a7e85.js"><link rel="prefetch" href="/my-blog/assets/js/23.f9133433.js"><link rel="prefetch" href="/my-blog/assets/js/24.86a7d541.js"><link rel="prefetch" href="/my-blog/assets/js/25.0aa2d6ab.js"><link rel="prefetch" href="/my-blog/assets/js/26.3e55392e.js"><link rel="prefetch" href="/my-blog/assets/js/27.ae2e0581.js"><link rel="prefetch" href="/my-blog/assets/js/28.aaa62b88.js"><link rel="prefetch" href="/my-blog/assets/js/29.55007ae9.js"><link rel="prefetch" href="/my-blog/assets/js/3.57915124.js"><link rel="prefetch" href="/my-blog/assets/js/30.63aac023.js"><link rel="prefetch" href="/my-blog/assets/js/31.d5607214.js"><link rel="prefetch" href="/my-blog/assets/js/32.a7ae912b.js"><link rel="prefetch" href="/my-blog/assets/js/33.58fcbfa4.js"><link rel="prefetch" href="/my-blog/assets/js/34.8538d781.js"><link rel="prefetch" href="/my-blog/assets/js/35.14a82428.js"><link rel="prefetch" href="/my-blog/assets/js/36.2ad806dd.js"><link rel="prefetch" href="/my-blog/assets/js/37.207a29ce.js"><link rel="prefetch" href="/my-blog/assets/js/39.83aff8a9.js"><link rel="prefetch" href="/my-blog/assets/js/40.bcbcfd03.js"><link rel="prefetch" href="/my-blog/assets/js/41.d0a94dfd.js"><link rel="prefetch" href="/my-blog/assets/js/42.f6011b50.js"><link rel="prefetch" href="/my-blog/assets/js/43.efd29b4c.js"><link rel="prefetch" href="/my-blog/assets/js/44.e5c9709c.js"><link rel="prefetch" href="/my-blog/assets/js/45.7656da3c.js"><link rel="prefetch" href="/my-blog/assets/js/46.0f46c833.js"><link rel="prefetch" href="/my-blog/assets/js/47.40ce4540.js"><link rel="prefetch" href="/my-blog/assets/js/48.3db9c583.js"><link rel="prefetch" href="/my-blog/assets/js/49.53285ac3.js"><link rel="prefetch" href="/my-blog/assets/js/50.4db56f99.js"><link rel="prefetch" href="/my-blog/assets/js/51.188f8c4f.js"><link rel="prefetch" href="/my-blog/assets/js/52.95be221e.js"><link rel="prefetch" href="/my-blog/assets/js/53.276e1791.js"><link rel="prefetch" href="/my-blog/assets/js/54.2fd73796.js"><link rel="prefetch" href="/my-blog/assets/js/55.c90a5bd8.js"><link rel="prefetch" href="/my-blog/assets/js/56.406f89df.js"><link rel="prefetch" href="/my-blog/assets/js/57.811f05ab.js"><link rel="prefetch" href="/my-blog/assets/js/58.e2896a54.js"><link rel="prefetch" href="/my-blog/assets/js/59.e5f3be54.js"><link rel="prefetch" href="/my-blog/assets/js/6.8ba90f8e.js"><link rel="prefetch" href="/my-blog/assets/js/60.e4b67c15.js"><link rel="prefetch" href="/my-blog/assets/js/61.7b772903.js"><link rel="prefetch" href="/my-blog/assets/js/62.bbe4352b.js"><link rel="prefetch" href="/my-blog/assets/js/63.e350ef3b.js"><link rel="prefetch" href="/my-blog/assets/js/64.7b6ca2f6.js"><link rel="prefetch" href="/my-blog/assets/js/65.76baf7fa.js"><link rel="prefetch" href="/my-blog/assets/js/66.ff801cea.js"><link rel="prefetch" href="/my-blog/assets/js/67.ee30cd5b.js"><link rel="prefetch" href="/my-blog/assets/js/68.0f4c1ce2.js"><link rel="prefetch" href="/my-blog/assets/js/69.111ce4de.js"><link rel="prefetch" href="/my-blog/assets/js/7.55078740.js"><link rel="prefetch" href="/my-blog/assets/js/70.46f8b5e8.js"><link rel="prefetch" href="/my-blog/assets/js/71.675e279c.js"><link rel="prefetch" href="/my-blog/assets/js/72.c419d947.js"><link rel="prefetch" href="/my-blog/assets/js/73.6eb4799a.js"><link rel="prefetch" href="/my-blog/assets/js/74.18229d2e.js"><link rel="prefetch" href="/my-blog/assets/js/75.46c8298d.js"><link rel="prefetch" href="/my-blog/assets/js/76.c966d3c5.js"><link rel="prefetch" href="/my-blog/assets/js/77.b31efc9c.js"><link rel="prefetch" href="/my-blog/assets/js/78.f7e57735.js"><link rel="prefetch" href="/my-blog/assets/js/79.e056b5a5.js"><link rel="prefetch" href="/my-blog/assets/js/8.ddecccf2.js"><link rel="prefetch" href="/my-blog/assets/js/80.0fc539d1.js"><link rel="prefetch" href="/my-blog/assets/js/81.2b7f0d10.js"><link rel="prefetch" href="/my-blog/assets/js/82.d3e4b716.js"><link rel="prefetch" href="/my-blog/assets/js/83.3073a1d2.js"><link rel="prefetch" href="/my-blog/assets/js/84.d231aeff.js"><link rel="prefetch" href="/my-blog/assets/js/85.7daed020.js"><link rel="prefetch" href="/my-blog/assets/js/86.0c8d8d8e.js"><link rel="prefetch" href="/my-blog/assets/js/87.c4ba5f03.js"><link rel="prefetch" href="/my-blog/assets/js/88.9a4e0ef6.js"><link rel="prefetch" href="/my-blog/assets/js/89.b7bca56b.js"><link rel="prefetch" href="/my-blog/assets/js/9.7463f385.js"><link rel="prefetch" href="/my-blog/assets/js/90.49ec4345.js"><link rel="prefetch" href="/my-blog/assets/js/91.84cb7a66.js"><link rel="prefetch" href="/my-blog/assets/js/92.cb5ea946.js"><link rel="prefetch" href="/my-blog/assets/js/93.05e2ac79.js"><link rel="prefetch" href="/my-blog/assets/js/94.e60969c0.js"><link rel="prefetch" href="/my-blog/assets/js/95.688af442.js"><link rel="prefetch" href="/my-blog/assets/js/96.aba3a873.js"><link rel="prefetch" href="/my-blog/assets/js/97.ca8196eb.js"><link rel="prefetch" href="/my-blog/assets/js/98.071b3a0f.js"><link rel="prefetch" href="/my-blog/assets/js/99.eca50447.js">
    <link rel="stylesheet" href="/my-blog/assets/css/0.styles.67b6080f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/my-blog/" class="home-link router-link-active"><!----> <span class="site-name">林山夕风</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/my-blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础教程" class="dropdown-title"><span class="title">基础教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/frontend/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/backend/" class="nav-link router-link-active">
  后端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/enjoy3/" class="nav-link">
  进阶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据结构与算法" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/structure/" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/algorithm/" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/leetcode/" class="nav-link">
  LeetCode题解
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计思想" class="dropdown-title"><span class="title">设计思想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/principle/" class="nav-link">
  设计原则
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/pattern/" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/thinking_in_java/" class="nav-link">
  Java编程思想
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/refactoring_improving_the_design_of_existing_code/" class="nav-link">
  重构改善既有代码的设计
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/project/" class="nav-link">
  项目实战
</a></div><div class="nav-item"><a href="/my-blog/article/" class="nav-link">
  零散文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/doomthr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/TanHaoran" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/my-blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础教程" class="dropdown-title"><span class="title">基础教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/frontend/" class="nav-link">
  前端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/backend/" class="nav-link router-link-active">
  后端
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/enjoy3/" class="nav-link">
  进阶
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据结构与算法" class="dropdown-title"><span class="title">数据结构与算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/structure/" class="nav-link">
  数据结构
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/algorithm/" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/leetcode/" class="nav-link">
  LeetCode题解
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="设计思想" class="dropdown-title"><span class="title">设计思想</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/principle/" class="nav-link">
  设计原则
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/pattern/" class="nav-link">
  设计模式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="读书笔记" class="dropdown-title"><span class="title">读书笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/my-blog/thinking_in_java/" class="nav-link">
  Java编程思想
</a></li><li class="dropdown-item"><!----> <a href="/my-blog/refactoring_improving_the_design_of_existing_code/" class="nav-link">
  重构改善既有代码的设计
</a></li></ul></div></div><div class="nav-item"><a href="/my-blog/project/" class="nav-link">
  项目实战
</a></div><div class="nav-item"><a href="/my-blog/article/" class="nav-link">
  零散文章
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="代码管理" class="dropdown-title"><span class="title">代码管理</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://gitee.com/doomthr" target="_blank" rel="noopener noreferrer" class="nav-link external">
  码云
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/TanHaoran" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>基础教程</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/my-blog/backend/线程基础.html" class="sidebar-link">线程基础</a></li><li><a href="/my-blog/backend/线程之间的共享和协作.html" class="sidebar-link">线程之间的共享和协作</a></li><li><a href="/my-blog/backend/线程的并发工具类.html" class="sidebar-link">线程的并发工具类</a></li><li><a href="/my-blog/backend/原子操作CAS.html" class="sidebar-link">原子操作CAS</a></li><li><a href="/my-blog/backend/显示锁和AQS.html" class="sidebar-link">显示锁和AQS</a></li><li><a href="/my-blog/backend/并发容器.html" class="sidebar-link">并发容器</a></li><li><a href="/my-blog/backend/线程池.html" class="sidebar-link">线程池</a></li><li><a href="/my-blog/backend/并发安全.html" class="sidebar-link">并发安全</a></li><li><a href="/my-blog/backend/JMM和底层实现原理.html" class="sidebar-link">JMM和底层实现原理</a></li><li><a href="/my-blog/backend/Java8新增的并发.html" class="sidebar-link">Java8新增的并发</a></li><li><a href="/my-blog/backend/常见并发面试题.html" class="sidebar-link">常见并发面试题</a></li><li><a href="/my-blog/backend/深入理解JVM内存区域.html" class="active sidebar-link">深入理解JVM内存区域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#一、为什么要了解虚拟机" class="sidebar-link">一、为什么要了解虚拟机</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#二、虚拟机历史" class="sidebar-link">二、虚拟机历史</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#解释执行和编译执行（针对字节码的执行）" class="sidebar-link">解释执行和编译执行（针对字节码的执行）</a></li></ul></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#三、未来的-java-技术" class="sidebar-link">三、未来的 Java 技术</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#_1、模块化" class="sidebar-link">1、模块化</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#_2、混合语言" class="sidebar-link">2、混合语言</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#_3、多核并行" class="sidebar-link">3、多核并行</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#_4、丰富语法" class="sidebar-link">4、丰富语法</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#_5、64位" class="sidebar-link">5、64位</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#_6、更强的垃圾回收器" class="sidebar-link">6、更强的垃圾回收器</a></li></ul></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#四、java-se-体系架构" class="sidebar-link">四、Java SE 体系架构</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#五、运行时数据区域" class="sidebar-link">五、运行时数据区域</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#_1、线程私有的区域" class="sidebar-link">1、线程私有的区域</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#_2、线程共享的区域" class="sidebar-link">2、线程共享的区域</a></li></ul></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#六、jvm各版本内存区域的变化" class="sidebar-link">六、JVM各版本内存区域的变化</a></li><li class="sidebar-sub-header"><a href="/my-blog/backend/深入理解JVM内存区域.html#七，直接内存" class="sidebar-link">七，直接内存</a></li></ul></li><li><a href="/my-blog/backend/JVM如何创建对象.html" class="sidebar-link">JVM如何创建对象</a></li><li><a href="/my-blog/backend/垃圾回收算法与垃圾回收器.html" class="sidebar-link">垃圾回收算法与垃圾回收器</a></li><li><a href="/my-blog/backend/JVM执行子系统.html" class="sidebar-link">JVM执行子系统</a></li><li><a href="/my-blog/backend/JVM性能优化.html" class="sidebar-link">JVM性能优化</a></li><li><a href="/my-blog/backend/MySQL安装和基础数据类型.html" class="sidebar-link">MySQL安装和基础数据类型</a></li><li><a href="/my-blog/backend/MySQL体系架构.html" class="sidebar-link">MySQL体系架构</a></li><li><a href="/my-blog/backend/MySQL锁与事务的分析.html" class="sidebar-link">MySQL锁与事务的分析</a></li><li><a href="/my-blog/backend/MySQL业务设计.html" class="sidebar-link">MySQL业务设计</a></li><li><a href="/my-blog/backend/MySQL慢查询.html" class="sidebar-link">MySQL慢查询</a></li><li><a href="/my-blog/backend/MySQL索引和执行计划.html" class="sidebar-link">MySQL索引和执行计划</a></li><li><a href="/my-blog/backend/MySQL的SQL优化.html" class="sidebar-link">MySQL的SQL优化</a></li><li><a href="/my-blog/backend/Linux基础.html" class="sidebar-link">Linux基础</a></li><li><a href="/my-blog/backend/反射：框架设计的灵魂.html" class="sidebar-link">反射：框架设计的灵魂</a></li><li><a href="/my-blog/backend/Java8新增特性.html" class="sidebar-link">Java8新增特性</a></li><li><a href="/my-blog/backend/MyBatis应用.html" class="sidebar-link">MyBatis应用</a></li><li><a href="/my-blog/backend/MyBatis源码骨架分析.html" class="sidebar-link">MyBatis源码骨架分析</a></li><li><a href="/my-blog/backend/MyBatis源码流程分析.html" class="sidebar-link">MyBatis源码流程分析</a></li><li><a href="/my-blog/backend/消息中间件入门，AMQP与RabbitMQ.html" class="sidebar-link">消息中间件入门，AMQP与RabbitMQ</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="深入理解jvm内存区域"><a href="#深入理解jvm内存区域" class="header-anchor">#</a> 深入理解JVM内存区域</h1> <div><span id="/my-blog/backend/深入理解JVM内存区域.html" data-flag-title="深入理解JVM内存区域" class="leancloud_visitors read-count"><em class="post-meta-item-text">阅读量 </em> <i class="leancloud-visitors-count">loading</i></span> <div class="clear-both"></div></div> <h2 id="一、为什么要了解虚拟机"><a href="#一、为什么要了解虚拟机" class="header-anchor">#</a> 一、为什么要了解虚拟机</h2> <p><code>JVM</code> 不单单只支持 <code>Java</code> 语言，也支持其他语言（<code>Scala</code>、<code>Kotlin</code>、<code>Groovy</code> 等等）</p> <p>区块链 2.0--以太坊(比特币是区块链 1.0) 中提供了 <code>EVM</code> 的虚拟机，它的实现和 <code>JVM</code> 类似，基于栈、生成脚本编译成字节码来执行。知识通用。（理论大于实际）</p> <h2 id="二、虚拟机历史"><a href="#二、虚拟机历史" class="header-anchor">#</a> 二、虚拟机历史</h2> <h3 id="解释执行和编译执行（针对字节码的执行）"><a href="#解释执行和编译执行（针对字节码的执行）" class="header-anchor">#</a> 解释执行和编译执行（针对字节码的执行）</h3> <p>解释执行就是边翻译为机器码边执行、即时编译（编译执行）就是先将一个方法中的所有字节码全部编译成机器码之后再执行。</p> <ul><li><code>Hotspot VM</code> （sun）</li></ul> <p>采用的是先解释执行，到了一定时机后将热点代码（多次执行、循环等）再翻译成机器码</p> <p>热点代码探测技术（通过执行计数器找到最有编译价值的代码，如果代码用得非常频繁，就会把这些代码编译成本地代码）。是目前应用最广泛的虚拟机。</p> <ul><li><code>JRockit VM</code> （BEA）</li></ul> <p>采取的方法是在执行 <code>class</code> 时直接编译为机器码（<code>Java</code> 程序启动速度会比较慢）</p> <ul><li><code>J9 VM</code> （IBM）</li></ul> <p>和 <code>Hotspot</code> 比较接近，主要是用在 <code>IBM</code> 产品（<code>IBM WebSphere</code> 和 <code>IBM</code> 的 <code>AIX</code> 平台上），华为有的项目用的 <code>J9</code>。</p> <ul><li><code>Google Android Dalivk VM</code> （谷歌）</li></ul> <p>使用的寄存器架构，执行 <code>dex</code>（<code>Dalvik Executable</code>）通过 <code>class</code> 转化而来。</p> <h2 id="三、未来的-java-技术"><a href="#三、未来的-java-技术" class="header-anchor">#</a> 三、未来的 Java 技术</h2> <h3 id="_1、模块化"><a href="#_1、模块化" class="header-anchor">#</a> 1、模块化</h3> <p><code>OSGI</code>（动态化、模块化），应用层面就是微服务，互联网的发展方向</p> <h3 id="_2、混合语言"><a href="#_2、混合语言" class="header-anchor">#</a> 2、混合语言</h3> <p>多个语言都可以运行在 <code>JVM</code> 中，<code>google</code> 的 <code>Kotlin</code> 成为了 <code>Android</code> 的官方语言。<code>Scala</code>(<code>Kafka</code>)</p> <h3 id="_3、多核并行"><a href="#_3、多核并行" class="header-anchor">#</a> 3、多核并行</h3> <p><code>CPU</code> 从高频次转变为多核心，多核时代。<code>JDK1.7</code> 引入了 <code>Fork/Join</code>，<code>JDK1.8</code> 提出 <code>lambda</code> 表达式(函数式编程天生适合并行运行)</p> <h3 id="_4、丰富语法"><a href="#_4、丰富语法" class="header-anchor">#</a> 4、丰富语法</h3> <p><code>JDK5</code> 提出自动装箱、泛型(并发编程讲到)、动态注解等语法。<code>JDK7</code> 二进制原生支持。<code>try-catch-finally</code> 至 <code>try-with-resource</code></p> <h3 id="_5、64位"><a href="#_5、64位" class="header-anchor">#</a> 5、64位</h3> <p>虽然同样的程序 64 位内存消耗比 32 位要多一点，但是支持内存大，所以虚拟机都会完全过渡到 64 位，32 位的 <code>JVM</code> 有 4G 的堆大小限制。</p> <h3 id="_6、更强的垃圾回收器"><a href="#_6、更强的垃圾回收器" class="header-anchor">#</a> 6、更强的垃圾回收器</h3> <p>现在主流 <code>CMS</code>、<code>G1</code>。<code>JDK11</code> 中的 <code>–ZGC</code>（暂停时间不超过 10 毫秒，且不会随着堆的增加而增加，TB 级别的堆回收））。</p> <p>有色指针、加载屏障。<code>JDK12</code> 支持并发类卸载，进一步缩短暂停时间 <code>JDK13</code>(计划于 2019 年 9 月)将最大堆大小从 4TB 增加到 16TB</p> <h2 id="四、java-se-体系架构"><a href="#四、java-se-体系架构" class="header-anchor">#</a> 四、Java SE 体系架构</h2> <ul><li>JavaSE</li></ul> <p><code>Java</code> 平台标准版，为 <code>Java EE</code> 和 <code>Java ME</code> 提供了基础。</p> <ul><li>JDK</li></ul> <p><code>Java</code> 开发工具包，<code>JDK</code> 是 <code>JRE</code> 的超集，包含 <code>JRE</code> 中的所有内容，以及开发程序所需的编译器和调试程序等工具。</p> <ul><li>JRE</li></ul> <p><code>Java SE</code> 运行时环境 ，提供库、<code>Java</code> 虚拟机和其他组件来运行用 <code>Java</code> 编程语言编写的程序。主要类库，包括：程序部署发布、用户界面工具类、继承库、其他基础库，语言和工具基础库</p> <ul><li>JVM</li></ul> <p><code>java</code> 虚拟机，负责 <code>Java SE</code> 平台的硬件和操作系统无关性、编译执行代码（字节码）和平台安全性</p> <h2 id="五、运行时数据区域"><a href="#五、运行时数据区域" class="header-anchor">#</a> 五、运行时数据区域</h2> <p>这个是抽象概念，内部实现依赖寄存器、高速缓存、主内存（具体要分析 <code>JVM</code> 源码的 <code>C++</code> 语言实现）</p> <p><code>JVM</code> 在运行过程中会把它所管理的内存划分成若干不同的数据区域。</p> <p>线程私有：程序计数器、虚拟机栈、本地方法栈</p> <p>线程共享：堆、方法区</p> <p><img src="https://yjtravel-public.oss-cn-beijing.aliyuncs.com/my-blog/basic/jvm.png" alt="运行时数据区域"></p> <p>线程私有是存储指令的，线程共享是存储数据的。</p> <p>计算机的运行 = 指令 + 数据，指令用于执行方法的，数据用于存放数据和对象的。</p> <h3 id="_1、线程私有的区域"><a href="#_1、线程私有的区域" class="header-anchor">#</a> 1、线程私有的区域</h3> <h4 id="_1-程序计数器"><a href="#_1-程序计数器" class="header-anchor">#</a> (1) 程序计数器</h4> <p>程序执行的计数器。占用较小的内存空间，当前线程执行的字节码的行号指示器；各线程之间独立存储，互不影响。</p> <p>如果线程正在执行的是一个 <code>Java</code> 方法，则指向的是当前线程执行的代字节码行数。</p> <p>如果正在执行的是 <code>Natvie</code> 方法，这个计数器值则为空（Undefined）</p> <p>此内存区域是唯一一个不会出现 <code>OutOfMemoryError</code> 情况的区域。</p> <h5 id="为什么需要程序计数器"><a href="#为什么需要程序计数器" class="header-anchor">#</a> 为什么需要程序计数器</h5> <p>因为 <code>Java</code> 是多线程的，当需要线程切换的时候需要确保多线程情况下程序能够正确执行，需要记录正在执行代码字节的行数。</p> <h4 id="_2-虚拟机栈"><a href="#_2-虚拟机栈" class="header-anchor">#</a> (2) 虚拟机栈</h4> <p>存储<strong>当前线程</strong>运行方法所需要的数据、指令和返回地址。</p> <p>栈数据结构的特点和 <code>Java</code> 中方法中调用方法的特性一致。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StackFilo</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// a() -&gt; b() -&gt; c()</span>
        <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;A开始&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 此处省略100行代码</span>
        <span class="token comment">// 调用 b() 方法</span>
        <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;A结束&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B开始&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 此处省略100行代码</span>
        <span class="token comment">// 调用 c() 方法</span>
        <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B结束&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;C开始&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 此处省略100行代码</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;C结束&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>上面代码依次入栈的方法为 <code>a()</code> -&gt; <code>b()</code> -&gt; <code>c()</code>，出栈的顺序为 <code>c()</code> -&gt; <code>b()</code> -&gt; <code>a()</code></p> <p>当线程请求的栈深度大于虚拟机所允许的深度时，会抛出 <code>StackOverflowError</code> 异常。</p> <p>当 <code>JVM</code> 动态扩展时无法申请到足够的内存时，会抛出 <code>OutOfMemoryError</code> 异常。</p> <p><code>虚拟机栈</code> 是每个线程私有的，线程在运行时，在执行每个方法的时候都会打包成一个<code>栈帧</code>，存储了局部变量表，操作数栈，动态链接，方法出口等信息，然后放入栈。每个时刻正在执行的当前方法就是虚拟机栈顶的栈桢。方法的执行就对应着栈帧在虚拟机栈中入栈和出栈的过程。</p> <p><code>虚拟机栈</code> 的大小缺省为 <code>1M</code>，可用参数 <code>–Xss</code> 调整大小，例如 <code>-Xss256k</code>。</p> <p>在编译程序代码的时候，栈帧中需要多大的局部变量表，多深的操作数栈都已经完全确定了，并且写入到方法表的 <code>Code</code> 属性之中，因此一个栈帧需要分配多少内存，不会受到程序运行期变量数据的影响，而仅仅取决于具体的虚拟机实现。</p> <p>通过 <code>javap -v xxx.class &gt; xxx.txt</code> 可以将 <code>class</code> 文件信息转化为一个文本信息，在文本信息中包含着字节码的信息。</p> <p>在字节码的方法中会包含一个 <code>Code</code> 属性的数据，下面举例介绍里面的几种语法：</p> <p>例如 <code>Java</code> 代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">int</span> money<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        money <span class="token operator">=</span> money <span class="token operator">-</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>通过上述指令执行后生成的文件中 <code>use()</code> 方法对应的内容如下：</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>  public void use(int);
    descriptor: (I)V
    flags: ACC_PUBLIC
    Code:
      stack=2, locals=2, args_size=2
         0: iload_1
         1: bipush        100
         3: isub
         4: istore_1
         5: return
      LineNumberTable:
        line 28: 0
        line 29: 5
      LocalVariableTable:
        Start  Length  Slot  Name   Signature
            0       6     0  this   Lcom/jerry/ch1/JavaStack;
            0       6     1 money   I
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>在 <code>Code</code> 属性中有一些指令，指令左边的数字代表的就是指令的行号。因为虚拟机在执行指令的过程中可能还在做一些其它的工作，所以行号没有连续。</p> <table><thead><tr><th>行号</th> <th>指令</th> <th>含义</th></tr></thead> <tbody><tr><td>0</td> <td>iload_1</td> <td>将下标为1的 <code>int</code> 型局部变量进栈</td></tr> <tr><td>1</td> <td>bipush</td> <td>将一个 <code>byte</code> 型常量（100）值推送至栈顶</td></tr> <tr><td>3</td> <td>isub</td> <td>栈顶两个 <code>int</code> 行数值相减（后入栈的 - 前入栈的），并且结果进栈</td></tr> <tr><td>4</td> <td>istore_1</td> <td>将栈顶 <code>int</code> 型数值存入第2个局部变量</td></tr></tbody></table> <ul><li>局部变量表（LocalVariableTable）</li></ul> <p>顾名思义就是局部变量的表，用于存放我们的局部变量的。首先它是一个 32 位的长度，主要存放我们的 <code>Java</code> 的八大基础数据类型，一般 32位就可以存放下，如果是 64 位的就使用高低位占用两个也可以存放下，如果是局部的一些对象，比如我们的 <code>Object</code> 对象，我们只需要存放它的一个引用地址即可。（基本数据类型、对象引用、<code>returnAddress</code> 类型）</p> <ul><li>操作数栈</li></ul> <p>存放我们方法执行的操作数的，它就是一个栈，先进后出的栈结构，操作数栈，就是用来操作的，操作的的元素可以是任意的 <code>Java</code> 数据类型，所以我们知道一个方法刚刚开始的时候，这个方法的操作数栈就是空的，操作数栈运行方法是会一直运行入栈/出栈的操作</p> <ul><li>动态连接</li></ul> <p><code>Java</code> 语言特性多态（需要类加载、运行时才能确定具体的方法，后续有详细的讲解）</p> <ul><li>返回地址</li></ul> <p>正常返回（调用程序计数器中的地址作为返回）三步曲</p> <ol><li>恢复上层方法的局部变量表和操作数栈</li> <li>把返回值（如果有的话）压入调用者栈帧的操作数栈中</li> <li>调整 <code>PC</code> 计数器的值以指向方法调用指令后面的一条指令</li></ol> <p>异常的话（通过异常处理器表（非栈帧中的）来确定）</p> <h4 id="_3-本地方法栈"><a href="#_3-本地方法栈" class="header-anchor">#</a> (3) 本地方法栈</h4> <p>本地方法栈保存的是 <code>native</code> 方法的信息，例如 <code>Object</code> 的 <code>hashCode()</code> 方法，当一个 <code>JVM</code> 创建的线程调用 <code>native</code> 方法后，<code>JVM</code> 不再为其在虚拟机栈中创建栈帧，<code>JVM</code> 只是简单地动态链接并直接调用 <code>native</code> 方法</p> <p>执行本地方法。各虚拟机自己实现，本地方法栈 <code>native</code> 方法调用 <code>JNI</code> 到了底层的 <code>C</code>/<code>C++</code>(<code>C</code>/<code>C++</code> 可以触发汇编语言，然后驱动硬件)</p> <h3 id="_2、线程共享的区域"><a href="#_2、线程共享的区域" class="header-anchor">#</a> 2、线程共享的区域</h3> <h4 id="_1-方法区"><a href="#_1-方法区" class="header-anchor">#</a> (1) 方法区</h4> <p>存储的内容：类信息、常量、静态常量、即时编译期编译后的代码。</p> <p>用于存储已经被虚拟机加载的类信息，常量（&quot;zdy&quot;,&quot;123&quot;等），静态变量（<code>static</code> 变量）等数据，可用以下参数调整：</p> <p><code>JDK1.7</code> 及以前叫永久代，<code>JDK1.8</code> 及以后叫元空间。</p> <p><code>jdk1.7</code> 及以前：<code>-XX:PermSize</code>；<code>-XX:MaxPermSize</code></p> <p><code>jdk1.8</code> 以后：<code>-XX:MetaspaceSize</code>； <code>-XX:MaxMetaspaceSize</code></p> <p><code>jdk1.8</code> 以后大小就只受本机总内存的限制</p> <p>如：<code>-XX:MaxMetaspaceSize=3M</code></p> <h4 id="_2-java堆"><a href="#_2-java堆" class="header-anchor">#</a> (2) Java堆</h4> <p>几乎所有对象都分配在这里，也是垃圾回收发生的主要区域，可用以下参数调整：</p> <p><code>-Xms</code>：堆的最小值；</p> <p><code>-Xmx</code>：堆的最大值；</p> <p><code>-Xmn</code>：新生代的大小；</p> <p><code>-XX:NewSize</code>；新生代最小值；</p> <p><code>-XX:MaxNewSize</code>：新生代最大值；</p> <p>例如运行时设置堆的最大值为256m的参数： <code>-Xmx256m</code></p> <h2 id="六、jvm各版本内存区域的变化"><a href="#六、jvm各版本内存区域的变化" class="header-anchor">#</a> 六、JVM各版本内存区域的变化</h2> <p>运行时常量池是指： <code>Class</code> 文件中的常量池（编译器生成的各种字面量和符号引用）在类加载后被放入的区域</p> <p>字面量：<code>String a = &quot;我是字面量&quot;</code> 中的 <code>&quot;我是字面量&quot;</code> 就是字面量。</p> <ul><li>jdk1.6</li></ul> <p>运行时常量池在方法区中</p> <ul><li>jdk1.7</li></ul> <p>运行时常量池在堆中</p> <ul><li>jdk1.8</li></ul> <p>去永久代：原来的永久代占用的内存可能还会与堆有相互的关系，但是使用元空间后大小只受制于机器的内存，为什么这么做呢？永久代来存储类信息、常量、静态变量等数据不是个好主意, 很容易遇到内存溢出的问题。
对永久代进行调优是很困难的，同时将元空间与堆的垃圾回收进行了隔离，避免永久代引发的 <code>Full GC</code> 和 <code>OOM</code> 等问题；</p> <h2 id="七，直接内存"><a href="#七，直接内存" class="header-anchor">#</a> 七，直接内存</h2> <p>不是虚拟机运行时数据区的一部分，也不是 <code>Java</code> 虚拟机规范中定义的内存区域，它是 <code>JVM</code> 无法直接管理的内存。</p> <p><img src="https://yjtravel-public.oss-cn-beijing.aliyuncs.com/my-blog/basic/jvm2.png" alt="JVM内存区域模型"></p> <p>如果使用了 <code>NIO</code>,这块区域会被频繁使用，在 <code>Java</code> 堆内可以用 <code>directByteBuffer</code> 对象直接引用并操作；</p> <p>这块内存不受 <code>Java</code> 堆大小限制，但受本机总内存的限制，可以通过 <code>MaxDirectMemorySize</code> 来设置（默认与堆内存最大值一样），所以也会出现 <code>OOM</code> 异常；</p> <p>避免了在 <code>Java</code> 堆和 <code>Native</code> 堆中来回复制数据，能够提高效率</p> <div><br> <div id="vcomments"></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020-08-21 09:02:51（10 小时前）</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/my-blog/backend/常见并发面试题.html" class="prev">
        常见并发面试题
      </a></span> <span class="next"><a href="/my-blog/backend/JVM如何创建对象.html">
        JVM如何创建对象
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/my-blog/assets/js/app.11c55fdf.js" defer></script><script src="/my-blog/assets/js/2.f643b0a2.js" defer></script><script src="/my-blog/assets/js/38.57c0d12e.js" defer></script><script src="/my-blog/assets/js/4.fd36f240.js" defer></script><script src="/my-blog/assets/js/5.628d6842.js" defer></script>
  </body>
</html>
